
var viewModel = {
            box1 : [
                {
                    alt: 'Detail of wrought iron table',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a1_s.jpg'
					 },
					 {
                    alt: 'Wrought iron table',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a2_s.jpg'
					 },
					 {
                    alt: 'Wrought iron table',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a3_s.jpg'
					 },
					 {
                    alt: 'Detail of wrought iron table',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a4_s.jpg'
					 },
					 {
                    alt: 'Forged details on the bar',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a5_s.jpg'
					 },
					 {
                    alt: 'Wrought iron bed',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a6_s.jpg'
					 },
					 {
                    alt: 'Forged details on the bar',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a7_s.jpg'
					 },
					 {
                    alt: 'Wrought iron table',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a8_s.jpg'
					 },
					 {
                    alt: 'Wrought iron shelving',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a9_s.jpg'
					 },
					 {
                    alt: 'Wrought iron table',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a10_s.jpg'
					 },
					 {
                    alt: 'Forged bag of sweets',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a11_s.jpg'
					 },
					 {
                    alt: 'Rustic doors for furnace',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/a12_s.jpg'
					 }
				],
				box2 : [
                {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b1_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b2_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b3_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b4_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b5_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b6_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b7_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b8_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b9_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b10_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b11_s.jpg'
					 },
					 {
                    alt: 'Wrought iron stair railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/b12_s.jpg'
					 }
				],
				box3 : [
                {
                    alt: 'Wrought iron balcony railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c1_s.jpg'
					 },
					 {
                    alt: 'Wrought iron balcony railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c2_s.jpg'
					 },
					 {
                    alt: 'Wrought iron balcony railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c3_s.jpg'
					 },
					 {
                    alt: 'Wrought iron balcony railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c4_s.jpg'
					 },
					 {
                    alt: 'Wrought iron balcony railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c5_s.jpg'
					 },
					 {
                    alt: 'Wrought iron balcony railing',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c6_s.jpg'
					 },
					 {
                    alt: 'Wrought iron gate',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c7_s.jpg'
					 },
					 {
                    alt: 'Wrought iron gate',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c8_s.jpg'
					 },
					 {
                    alt: 'Wrought iron gate',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c9_s.jpg'
					 },
					 {
                    alt: 'Wrought iron gate',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c10_s.jpg'
					 },
					 {
                    alt: 'Wrought iron gate',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c11_s.jpg'
					 },
					 {
                    alt: 'Wrought iron gate',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/c12_s.jpg'
					 }
				],
				box4 : [
                {
                    alt: 'Forged sculptures',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d1_s.jpg'
					 },
					 {
                    alt: 'Forged sculptures',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d2_s.jpg'
					 },
					 {
                    alt: 'Forged pavilion',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d3_s.jpg'
					 },
					 {
                    alt: 'Forged shelter',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d4_s.jpg'
					 },
					 {
                    alt: 'Forged pavilion',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d5_s.jpg'
					 },
					 {
                    alt: 'Wrought iron window nets',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d6_s.jpg'
					 },
					 {
                    alt: 'Wrought iron window nets',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d7_s.jpg'
					 },
					 {
                    alt: 'Wrought iron window nets',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d8_s.jpg'
					 },
					 {
                    alt: 'Wrought iron window nets',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d9_s.jpg'
					 },
					 {
                    alt: 'From workshop',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d10_s.jpg'
					 },
					 {
                    alt: 'From workshop',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d11_s.jpg'
					 },
					 {
                    alt: 'From workshop',
                    src: 'http://eve-star.co.uk/spiral/kovastvo/d12_s.jpg'
					 }
				]
        }
        $(document).ready(function(){
				$('#table2').hide();
            $('#table1').hide();
            $('input[id^=a_]').on('keyup', function(){
                var A = Number($('#a_A').val());
                var rising = Number($('#a_rising').val());
                var bQ = Number($('#a_BQ').val());
                
                $('#table1 tbody tr').remove();
                $('<tr>' +
                        '<th>S1</th>' +
                        '<td>' + A + '</td>' +
                       '</tr>'
                      ).appendTo('#table1 tbody');
                for(var i=1; i < bQ; i++){
                    var distance = rising * i + A;
                    var start = i + 1;
                    $('<tr>' +
                        '<th>S' + start + '</th>' +
                        '<td>' + distance + '</td>' +
                       '</tr>'
                      ).appendTo('#table1 tbody');
                }
                
                if(bQ > 0){
                    $('#bar1').fadeOut('fast');
                    $('#table1').fadeIn('slow');
                } else{
                    $('#bar1').fadeIn('slow');
                    $('#table1').fadeOut('fast');
                }
            });
            
            //calculate x and circumference
            $('input[id^=b_]').on('keyup', function(){
					 $('#table2').fadeIn();
					 var radius = Number($('#b_radius').val());
					 var angle = Number($('#b_angle').val());
						  angle = angle / 2;
					 var angleRadian = (Math.PI / 180) * angle;
					 var a = Math.sin(angleRadian);
					 var x = a * radius * 2;
						  x = x.toFixed(1);
					 $('#b_x').text(x);
					 
					 var pointNumber = 360 / (angle * 2);
						  pointNumber = Math.floor(pointNumber);
						  angle_D = 360 - (pointNumber * 2 * angle);
					 var angle_D_Radian = (Math.PI / 180) * angle_D;
					 var a_D = Math.sin(angle_D_Radian);
					 var D = a_D * radius;
						  D = D.toFixed(1);
					 $('#b_x').text(x);
					 $('#b_D').text(D);
            });
				
				//calculate arc and circumference
				$('input[id^=c_]').on('keyup', function(){
					 $('#bar2').fadeOut();
					 var BQ = Number($('#c_BQ').val());
					 var diameter = Number($('#c_diameter').val());
					 var angle = Number($('#c_angle2').val());
					 
					 var C = diameter * Math.PI;
					 var arc = C / 360 * angle;
						  C = Math.round(C);
					 
					 $('#table3 tbody tr').remove();
                $('<tr>' +
                        '<th>Circumference:</th>' +
                        '<td>' + C + '</td>' +
                       '</tr>'
                      ).appendTo('#table3 tbody');
                for(var i=1; i < BQ; i++){
                    var arc_n = Math.round(arc * i);
                    var start = i;
                    $('<tr>' +
                        '<th>arc' + start + '</th>' +
                        '<td>' + arc_n + '</td>' +
                       '</tr>'
                      ).appendTo('#table3 tbody');
                }
				});
            
            ko.applyBindings(viewModel);
    
        });
        $(document).live('pageinit', function(){
				 //Open image dialog
            $('#gallery img').live('tap', function(){
					 $.mobile.showPageLoadingMsg();
                var imgInfo = $(this).attr('src');
                var photoPathArr = imgInfo.split('_');
                var imgPath = photoPathArr[0] + '_b.jpg';
					 var header_h1 = $(this).attr('alt');
					 $('#photoPage .img_DWG').attr('src', imgPath);
					 $('#photoPage h1').text(header_h1);
            });
				
				//load workshop photos
				$('#btn1').live('tap', function(){
					 $('#photoSpiral div:eq(1) img').remove();
					 $('<img src="http://eve-star.co.uk/spiral/photos/b1_a.gif" alt="ring" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b2_a.gif" alt="cutting hole" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b3_a.gif" alt="tapping tread" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b4_a.gif" alt="welding ring" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b5_a.gif" alt="welding bar" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b6_a.gif" alt="welding protection" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b7_a.gif" alt="post" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b8_a.gif" alt="tread" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
					 $('<img src="http://eve-star.co.uk/spiral/photos/b9_a.gif" alt="laptop in workshop" class="img_DWG"/>').appendTo('#photoSpiral div:eq(1)');
				});
				
        });
		  










var pi = Math.PI;
var y = 360;
$(document).ready(function(){
    $('input[id^=d]').bind('keyup', function(){
        $('input[id^=d]').attr('placeholder', '');
        var stairsRising = Number($('#d_stairsRising').val());
        var stairsAngle = Number($('#d_stairsAngle').val());
        var balustradeRadius = Number($('#d_balustradeRadius').val());
        var stepQuantity = Number($('#d_stepQuantity').val());
        
        var k = y / stairsAngle;
        var H = stairsRising * k;
        var by = 2 * pi * balustradeRadius;
        var bottom = by * by + H * H;
        var top = 4 * pi * pi * balustradeRadius;
        var curvature = bottom / top;
        curvature = curvature.toFixed(0);
        
        $('#dd_curvature').text(curvature);
        
        var k1 = stairsAngle / y;
        var C = 2 * pi * balustradeRadius * k1;
        var length = C * C + stairsRising * stairsRising;
        length = Math.sqrt(length);
        length = length.toFixed(0);
        C = C.toFixed(0);
        
        $('#dd_handrailLength').text(length);
        $('#dd_circumference').text(C);
        
        var C1 = 2 * pi * balustradeRadius;
        var a = stairsRising / C1;
        var angle = Math.atan(a);
        var angleDegree = angle * 180 / pi;
        var D90 = 90 - angleDegree * 0.933;
        D90 = D90.toFixed(1);
        
        $('#dd_balusterAngle').text(D90);
        
        var stepRising = stairsRising / stepQuantity;
        stepRising = stepRising.toFixed(1);
        
        $('#dd_stepRising').text(stepRising);
    });
});

