
























var Email={options:void 0,pageID:void 0,listviewID:void 0,listviewSplitOnclick:void 0,handlers:{}};
$(document).on("appready",function(){Email.showPage=function(a){Common.showLoading();if(!a||!a.back||!a.backText||!a.backIcon){a||(a={});var b=!1;a.back||(a.back=function(){Main.showHome(!0)},b=!0);a.backText||(a.backText=b?"Home":Transl("MainBack","Back"));a.backIcon||(a.backIcon=b?"home":"arrow-l");a.emailType||(a.emailType="LI")}Email.options=a;$("#send_email_subject").val(a.subject||"");$("#send_email_attachment").val(a.attachment||"");$("#send_email_text").val("");b=$("#send_email_back");b.attr("data-icon",
a.backIcon);b.hasClass("ui-btn")&&(b.find("> span.ui-btn-inner > span.ui-icon").attr("class","ui-icon ui-icon-"+a.backIcon+" ui-icon-shadow"),b=b.find("> span.ui-btn-inner > span.ui-btn-text"));b.text(a.backText);$("#send_mail_pdf_header_1")[0].checked=!0;$("#send_mail_pdf_culture_"+(Translations.currentCultureName||"it-IT"))[0].checked=!0;$("#send_mail_pdf_type_basic")[0].checked=!0;a.attachment?$("#send_mail_li_pdf_language,#send_mail_li_pdf_header,#send_mail_li_attachment").css("display","block"):
$("#send_mail_li_pdf_language,#send_mail_li_pdf_header,#send_mail_li_attachment").css("display","none");"M"==a.objType||"V"==a.objType||"G"==a.objType?$("#send_mail_li_pdf_type").css("display","block"):$("#send_mail_li_pdf_type").css("display","none");var c=$("#send_email_to_list")[0];Common.clearList(c);Common.clearList($("#send_email_cc_list")[0]);a.toEmail&&Common.emailRegex.test(a.toEmail)?(b=Email._createEmailData(a.toEmail,a.toAnagID,a.toAnagText,a.toAnagCode,a.toEmailText),Common.addListItem(c,
{text:b.text,href:"#",data:b,splitText:"Remove",splitOnclick:Email.handlers.listViewRemove_Click}),Common.changePage("send_email","slide",!1)):a.toAnagID?N2WcfClient.invoke("GetFirstMail",{IDAnag:a.toAnagID,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(b){if(b.Address[0].Text){var e=b.Address[0].Text.trim();if(Common.emailRegex.test(e)){b=Email._createEmailData(e,a.toAnagID,a.toAnagText,a.toAnagCode,b.Text[0].Text);Common.addListItem(c,
{text:b.text,href:"#",data:b,splitText:"Remove",splitOnclick:Email.handlers.listViewRemove_Click})}}Common.changePage("send_email","slide",false)},Common.wcfError):Common.changePage("send_email","slide",!1)};$("#send_email").on("pagebeforeshow",function(){$("#send_email_to_list").listview("refresh");$("#send_email_cc_list").listview("refresh");$("#send_email input:radio").checkboxradio("refresh")});$("#send_email").on("pageshow",function(){$("#send_email_ul").listview("refresh")});Email.handlers.searchEmail_Click=
function(a){Email._showSearch("send_email",a?"send_email_cc_list":"send_email_to_list",Email.handlers.listViewRemove_Click)};Email.handlers.addEmail_Click=function(a){Email._showAdd(a?"send_email_cc_list":"send_email_to_list",Email.handlers.listViewRemove_Click)};Email.handlers.listViewRemove_Click=function(){var a=$(this).closest("li"),b=a.parent(),c=a.data("dataObj").text;Common.confirm(Transl("MainDelete","Are you sure you want to delete {0}?").format('"'+c+'"'),function(){a.remove();b.refresh()})};
Email.send=function(){var a=$("#send_email_to_list > li"),b=$("#send_email_cc_list > li"),c=$("#send_email_subject").val(),g=$("#send_email_text").val();0==a.length?Common.alert(Transl("SendMailEmptyTo",'You must enter at least one valid email address in the "To" field.')):c?3<=a.length&&0<b.length?Common.confirm(Transl("SendMailAlertCC_1","Warning: recipients in cc will recive")+" "+a.length+" "+Transl("SendMailAlertCC_2","emails. Continue?"),function(){Email._send(a,b,c,g)}):Email._send(a,b,c,g):
Common.alert(Transl("SendMailEmptySubject",'The "Subject" field is required.'))};Email._send=function(a,b,c,g){Common.showLoading();for(var e=[],d=0;d<a.length;d++){var f=$.data(a[d],"dataObj");e.push({RecipientType:"To",Address:f.email,IDAnag:f.anagID||void 0})}for(d=0;d<b.length;d++)f=$.data(b[d],"dataObj"),e.push({RecipientType:"Cc",Address:f.email,IDAnag:f.anagID||void 0});a=[];if(Email.options.objID&&Email.options.objType&&Email.options.pdfFileName){for(d=b=1;3>=d;d++)if(!0===$("#send_mail_pdf_header_"+
d)[0].checked){b=d;break}for(var f="it-IT",h="it-IT en-US fr-FR de-DE es-ES ru-RU".split(" "),d=0;d<h.length;d++)if(!0===$("#send_mail_pdf_culture_"+h[d])[0].checked){f=h[d];break}h=0;if("block"==$("#send_mail_li_pdf_type").css("display"))for(var i=["basic","basic_images","complete"],d=0;d<i.length;d++)if(!0===$("#send_mail_pdf_type_"+i[d])[0].checked){h=d;break}a.push({IDObj:Email.options.objID,ObjType:Email.options.objType.charCodeAt(0),ObjDescr:Email.options.pdfFileName,PDFType:h,IDHeader:b,Culture:f})}d=
new Date;c={IDEmail:Util.createNewGuid(),InsUser:CM.getIDUser(),IDGroup:CM.getIDGroup(),EmailType:Email.options.emailType,FromDisplayName:CM.getEmailAlias(),FromEmail:CM.getEmail(),Subject:c,Body:Util.textToXaml(g),IsBodyHtml:!0,Priority:0,DeliveryNotification:!1,InsDate:d,RequestDate:d,Attacheds:"",Recipients:{Recipient:e},Objs:{Obj:a}};N2WcfClient.insertIntoQueue({body:c,bodyType:"Mail",guid:c.IDEmail,priority:"VeryLow"},function(){Common.alert(Transl("SendMailEmailSent","Email successfully sent."),
function(){Email._close()})},Common.wcfError,CM.getIDUser(),CM.getIDGroup(),CM.getGuidUser(),CM.getUsername(),CM.getPassword())};$("#search_email").on("pageshow",function(){Common.focusToField("search_email_search_txt")});Email._showSearch=function(a,b,c){Email.pageID=a;Email.listviewID=b;Email.listviewSplitOnclick=c;Common.clearList($("#search_email_list")[0]);$("#search_email_search_txt").val("");Common.changePage("search_email","pop")};Email._showAdd=function(a,b){Email.listviewID=a;Email.listviewSplitOnclick=
b;Email._promptEmail()};Email._promptEmail=function(){var a=prompt(Transl("SendMailEnterEmail","Enter the email you want to add."));a&&(Common.emailRegex.test(a)?(a=a.toLowerCase(),N2WcfClient.invoke("AssociateEmailsToAnags",{EmailsToValidate:{$xmlns:"a:serializationArrays",string:a},IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(b){var c;b.KeyValueOfstringsp_GetAnagFromEmailResulttOkR_PX0r&&(b=b.KeyValueOfstringsp_GetAnagFromEmailResulttOkR_PX0r,
1==b.length&&(c=Email._createEmailData(a,b[0].Value[0].IDAnag[0].Text,b[0].Value[0].AnagName[0].Text,b[0].Value[0].Code[0].Text,b[0].Value[0].EmailText[0].Text)));c||(c=Email._createEmailData(a));b=$("#"+Email.listviewID);Common.addListItem(b[0],{text:c.text,href:"#",data:c,splitText:"Remove",splitOnclick:Email.listviewSplitOnclick});b.listview("refresh")},Common.wcfError)):Common.alert(Transl("SendMailEmailNotValid","The email {0} is not valid.").format('"'+a+'"'),Email._promptEmail))};Email._close=
function(){"string"==typeof Email.options.back?Common.changePage(Email.options.back,"slide",!0):Email.options.back()};Email.handlers.chooseEmailClose_Click=function(){Common.changePage(Email.pageID,"pop",!0)};Email.handlers.chooseEmailSearch_Click=function(){var a=$("#search_email_search_txt").val();3<=a.length&&(Common.showLoading(),N2WcfClient.invoke("GetEmailsFromString",{String:a,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){var c=
$("#search_email_list"),g=c[0];Common.clearList(g);if(a.sp_GetEmailsFromStringResult){for(var a=a.sp_GetEmailsFromStringResult,e=0;e<a.length;e++){var d=Email._createEmailData(a[e].Email[0].Text,a[e].IDAnag[0].Text,a[e].AnagName[0].Text,a[e].Code[0].Text,a[e].EmailText[0].Text);Common.addListItem(g,{text:d.fullText,onclick:Email.handlers.chooseEmailListItem_Click,data:d})}c.listview("refresh")}Common.hideLoading()},Common.wcfError))};Email.handlers.chooseEmailListItem_Click=function(){var a=$(this).closest("li"),
b=a.data("dataObj");a.addClass("ui-btn-active");Common.addListItem($("#"+Email.listviewID)[0],{text:b.text,href:"#",data:b,splitText:"Remove",splitOnclick:Email.listviewSplitOnclick});Common.changePage(Email.pageID,"pop",!0)};Email._createEmailData=function(a,b,c,g,e){a=a.trim();c&&(c=c.toString().trim());g&&(g=g.toString().trim());e&&(e=e.toString().trim());var d,f;c&&(f=d=c);if(c&&(g||e))f+=" (";g&&(f+=g);g&&e&&(f+=" - ");e&&(f+=e);if(c&&(g||e))f+=")";return{anagID:b,email:a,text:d?d+(" <"+a+">"):
a,fullText:f?f+(" <"+a+">"):a}}});





var Translations={currentCulture:void 0,currentCultureName:void 0,changingInProgess:!1,cultures:{"it-IT":{entries:void 0,decimalSeparator:",",thousandSeparator:"."},"en-US":{entries:void 0,decimalSeparator:".",thousandSeparator:","},"fr-FR":{entries:void 0,decimalSeparator:",",thousandSeparator:" "},"de-DE":{entries:void 0,decimalSeparator:",",thousandSeparator:"."},"es-ES":{entries:void 0,decimalSeparator:",",thousandSeparator:"."},"ru-RU":{entries:void 0,decimalSeparator:",",thousandSeparator:" "}},
init:function(a,f,g){a&&!Translations.cultures[a]&&(a=null);if(!a){var c=(navigator.language||navigator.browserLanguage).toLowerCase(),d;for(d in Translations.cultures){var b=d.toLowerCase();if(c==b||c==b.substr(0,2)){a=d;break}}}Translations.changeCulture(a||"en-US",f,g)},get:function(a){return Translations.changingInProgess?void 0:Translations.currentCulture.entries[a]},changeCulture:function(a,f,g){Translations.changingInProgess?g&&g():Translations.currentCultureName!=a?Translations.cultures[a].entries?
($("[data-translation]:not(select,ul)").each(function(){var c=$(this),d=this.getAttribute("data-translation"),b=Translations.cultures[a].entries[d],e=c.attr("data-translation-format");e&&(b="@"===e.substr(0,1)?b.format.apply(b,eval("["+e.substr(1)+"]")):b.format.apply(b,e.split(",")));b?(b=b.replace(/\n/g,"<br />"),c.is("fieldset[data-role='controlgroup']")?c.is(".ui-controlgroup")?c.children("div.ui-controlgroup-label").html(b):c.children("legend").html(b):c.parent().is(".ui-slider-switch")?(c.parent().next().find(".ui-slider-label-"+
(c.index()?"a":"b")).html(b),c.html(b)):(d=c.find("span.ui-btn-text"),1==d.length?d.html(b):c.html(b))):console.log("Invalid tranlsation key: "+d)}),$.each(["value","alt","title"],function(){var c=this.toString();$("[data-translation-"+c+"]").each(function(){var d=$(this),b=Translations.cultures[a].entries[d.attr("data-translation-"+c)];d.attr(c,b);if("value"==c&&d.hasClass("ui-btn-hidden")){var e=this.nodeName.toLowerCase();("button"==e||"input"==e&&-1<$.inArray(d.attr("type"),["button","submit",
"reset","image"]))&&d.parent().find("span.ui-btn-text").html(b)}})}),$(".ui-select select").find("option[data-translation]:first").parent().refresh(),Translations.currentCultureName=a,Translations.currentCulture=Translations.cultures[a],f&&f(),$(document).trigger("culturechanged")):(Translations.changingInProgess=!0,App.getComponents(["languages/"+a+"/Anag.xml","languages/"+a+"/AnagDett.xml","languages/"+a+"/DigiDataGrid.xml","languages/"+a+"/EngineDett.xml","languages/"+a+"/Composer.xml","languages/"+
a+"/Gallery.xml","languages/"+a+"/Mail.xml","languages/"+a+"/Main.xml","languages/"+a+"/Obj.xml","languages/"+a+"/ObjDett.xml","languages/"+a+"/OperationButtons.xml","languages/"+a+"/Prev.xml","languages/"+a+"/PrevDett.xml","languages/"+a+"/RegistrationModule.xml","languages/"+a+"/SendMail.xml"],function(c){Translations.cultures[a].entries={};for(var d=0;d<c.length;d++)for(var b=c[d],e=0;e<b.documentElement.childNodes.length;e++){var h=b.documentElement.childNodes[e];if("sys:String"==h.nodeName){var i=
h.childNodes[0].nodeValue,i=i.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/_/g,"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");Translations.cultures[a].entries[h.attributes.getNamedItem("x:Key").nodeValue]=i}}Translations.changingInProgess=!1;Translations.changeCulture(a,f,g)},function(){Translations.changingInProgess=!1;g&&g()})):f&&f()}};function Transl(a,f){return Translations.get(a)||f};



var Main={refreshUserDelay:75E3,refreshUserExpiration:122E3,getUserLoggedDelay:36E5,_refreshUserIsTimerActive:!1,_refreshUserTimeoutID:null,_refreshUserJQXhr:null,_getUserLoggedJQXhr:null,handlers:{}};
$(document).on("appready",function(){$("#login").on("pagebeforeshow",function(){$("#login > [data-role='header'] > h2").text(App.name);!$("#remember_me_one_day").checked()&&(!$("#remember_me_forever").checked()&&!$("#remember_me_never").checked())&&$("#remember_me_one_day").checked(!0);Main._cultureChanged()}).on("pageshow",function(){Common.focusToField("username")});$("#home").on("pagebeforeshow",function(){Main._cultureChanged()});Main.handlers.login_Click=function(){var a=$("#username").val(),
b=$("#password").val();if(!a||!b)Common.alert(Transl("MainEmptyUsernamePassword","Enter username and password."));else{var c=null,e=!$("#remember_me_never").checked();e&&$("#remember_me_one_day").checked()&&(c=new Date,c.addDays(1));Common.showLoading();Main.loginStoreCredentials(a,b,e,c,Main.showHome,Common.wcfError)}};Main.handlers.cultureLoginSelector_Changed=function(){Common.showLoading();for(var a in Translations.cultures)$("#main_culture_"+a).checked()&&Translations.changeCulture(a,Main._cultureChanged,
Main._cultureChanged)};Main.handlers.cultureHomeSelector_Changed=function(){Common.showLoading();var a=$("#home_culture").uiVal();Translations.changeCulture(a,Main._cultureChanged,Main._cultureChanged);Common.clearTables();CM.setCulture(a)};Main._cultureChanged=function(){$("#main_culture_"+Translations.currentCultureName).checked(!0);$("#home_culture").uiVal(Translations.currentCultureName);Common.hideLoading()};Main.loginStoreCredentials=function(a,b,c,e,g,f,h,i){Main.getUserLogged(a,b,function(d){Main.login(a,
b,function(){CM.store(a,b,d.name,d.idUser,d.idGroup,d.guidUser,d.email,d.emailAlias,d.uniqueID,Translations.currentCultureName,d.freeUser.toString(),c,e)?(Main.refreshUserEnableTimer(!0),g()):h()},f,h,i)},f,h,i)};Main.login=function(a,b,c,e,g,f){return N2WcfClient.invoke("LogIn",{user:a,pwd:b,version:Main._getAppInfoForLogin()},function(a){var b=Util.toInt(a.sp_LogInResult[0].ResultCode[0].Text),d=Util.toInt(a.sp_LogInResult[0].Expiring[0].Text),a=Util.toInt(a.sp_LogInResult[0].Maintenance[0].Text);
if(2==b&&(null===d||0<d)&&(null===a||0<a))c();else if(CredentialsManager.areCredentialsStored()&&Main.logoutNoConfirm(!0),Common.hideLoading(),g&&g(),f)Common.alert(f);else switch(b){case -1:Common.alert(Transl("MainUnexpectedErrorDB","Unexpected error: database not available. Please try later."));break;case 0:Common.alert(Transl("MainUnexpectedErrorAuthentication","Unexpected error in the authentication procedure."));break;case 1:Common.alert(Transl("MainErrorUsernamePassword","Username or password wrong."));
break;case 3:Common.alert(Transl("MainAlreadyConnected","Your user is already connected. Disconnect it and repeat the operation."));break;default:0>=d?Common.alert(Transl("MainAccountExpiredCloseApplication","Your account has expired. The application will be closed.")):0>=a&&Common.alert(Transl("MainMaintenance","Maintenance activities ongoing. The application will be closed."))}},e,null,{timeout:5E3})};Main.getUserLogged=function(a,b,c,e,g,f){return N2WcfClient.invoke("GetUserLogged",{user:a,pwd:b,
version:Main._getAppInfoForLogin()},function(a){var b=null;a.sp_GetUserLoggedResult&&(a=a.sp_GetUserLoggedResult[0],b={idUser:a.IDUser[0].Text,idGroup:a.IDGroup[0].Text,name:a.Name[0].Text,guidUser:a.GUIDUser[0].Text,email:a.EMail[0].Text,emailAlias:a.SenderEmailAlias[0].Text,iNavis:"true"==a.INavis[0].Text,freeUser:"true"==a.FreeUser[0].Text,uniqueID:a.UniqueID[0].Text});!b||!b.iNavis||!b.uniqueID?(CredentialsManager.areCredentialsStored()&&Main.logoutNoConfirm(),Common.hideLoading(),g&&g(),f?Common.alert(f):
b?b.iNavis?b.uniqueID||Common.alert(Transl("MainErrorUserDataNotAvailable","Unexpected error. User data not available.")):Common.alert(Transl("MainAccountNotEnabledToLogOn","Your account is not enabled to log on.")):Common.alert(Transl("MainErrorUsernamePassword","Username or password wrong."))):c(b)},e)};Main._getAppInfoForLogin=function(){var a=App.name+" "+(App.cordova?"App":"Web")+" v"+App.version;if(App.platform.iOS||App.platform.android)a+=" ("+(App.platform.iOS?"iOS":"Android")+" "+App.platform.version.value+
")";return a};Main.logout=function(){Common.confirm(Transl("MainQuit","Are you sure you really want to quit?"),Main.logoutNoConfirm)};Main.logoutNoConfirm=function(a){Common.reset("body");Quotations.areLoaded=!1;Quotations.areConfigurationsLoaded=!1;Common.clearTables();Main.refreshUserDisableTimer();a||N2WcfClient.invoke("LogOut",{IdUser:CM.getIDUser(),user:CM.getUsername(),pwd:CM.getPassword()});CM.clear();Common.changePage("login","slide",!0)};Main.checkUserPermissions=function(){CM.areCredentialsStored()&&
Main.getUserLogged(CM.getUsername(),CM.getPassword())};Main.refreshUserEnableTimer=function(a){Main.refreshUserDisableTimer();Main._refreshUserIsTimerActive=!0;a?(a=(new Date).getTime().toString(),CM.setRefreshUserLastCall(a),CM.setGetUserLoggedLastCall(a),Main._refreshUserJQXhr=null,Main._refreshUserTimeoutID=window.setTimeout(Main._refreshUser,Main.refreshUserDelay)):Main._refreshUser()};Main.refreshUserDisableTimer=function(){Main._refreshUserIsTimerActive=!1;null!==Main._refreshUserTimeoutID&&
(window.clearTimeout(Main._refreshUserTimeoutID),Main._refreshUserTimeoutID=null);null!==Main._refreshUserJQXhr&&(4!=Main._refreshUserJQXhr.readyState&&Main._refreshUserJQXhr.abort(),Main._refreshUserJQXhr=null);null!==Main._getUserLoggedJQXhr&&(4!=Main._getUserLoggedJQXhr.readyState&&Main._getUserLoggedJQXhr.abort(),Main._getUserLoggedJQXhr=null)};Main._refreshUser=function(){Main._refreshUserTimeoutID=null;if(CM.areCredentialsStored()){var a=CM.getRefreshUserLastCall();Main._refreshUserJQXhr=!a||
(new Date).getTime()-Util.toInt(a)>Main.refreshUserExpiration?Main.login(CM.getUsername(),CM.getPassword(),Main._refreshUserCallSuccess,Main._refreshUserCallConnectionError):N2WcfClient.invoke("RefreshUser",{IdUser:CM.getIDUser(),user:CM.getUsername(),pwd:CM.getPassword()},function(a){var c=Util.toInt(a.sp_RefreshUserResult[0].Expiring[0].Text),a=Util.toInt(a.sp_RefreshUserResult[0].Maintenance[0].Text);(null===c||0<c)&&(null===a||0<a)?Main._refreshUserCallSuccess():(Main.logoutNoConfirm(),0>=c?Common.alert(Transl("MainAccountExpiredCloseApplication",
"Your account has expired. The application will be closed.")):0>=a&&Common.alert(Transl("MainMaintenance","Maintenance activities ongoing. The application will be closed.")))},Main._refreshUserCallConnectionError,null,{timeout:5E3})}};Main._refreshUserCallSuccess=function(){CM.setRefreshUserLastCall((new Date).getTime().toString());Main._refreshUserJQXhr=null;Main._refreshUserTimeoutID=window.setTimeout(Main._refreshUser,Main.refreshUserDelay);var a=CM.getGetUserLoggedLastCall();if(!a||(new Date).getTime()-
Util.toInt(a)>Main.getUserLoggedDelay)Main._getUserLoggedJQXhr=Main.getUserLogged(CM.getUsername(),CM.getPassword(),function(a){CredentialsManager.setName(a.name);CredentialsManager.setEmail(a.email);CredentialsManager.setEmailAlias(a.emailAlias);CM.setGetUserLoggedLastCall((new Date).getTime().toString())})};Main._refreshUserCallConnectionError=function(){Main._refreshUserIsTimerActive&&(Main._refreshUserJQXhr=null,Main._refreshUserTimeoutID=window.setTimeout(Main._refreshUser,3E3))};Main.showHome=
function(a){var b="true"==CM.getIsFreeUser();$("#home_quotations_btn").css("display",b?"none":"");$("#discover_navispost_btn").css("display",b?"":"none");$("#home .header h2").text(App.name+" - "+CM.getName());Common.changePage("home","slide",a)}});


var Contacts={handlers:{},current:{id:null,code:null,originalMain:null,phones:null,emails:null,categories:null,objAnag:null,modified:null},backOptions:null};
$(document).on("appready",function(){Contacts.showList=function(a){Common.showLoading();0==$("#contacts_list > li").length&&$("#contacts_search_txt").val("");Common.changePage("contacts","slide",a)};$("#contacts").on("pageshow",function(){Common.focusToField("contacts_search_txt")});Contacts.handlers.search_Click=function(){Common.showLoading();N2WcfClient.invoke("GetAnag",{IDGroup:CM.getIDGroup(),Cognome:$("#contacts_search_txt").val(),PersFis:!0,PersGiu:!0,IDUser:CM.getIDUser(),Limit:100,User:CM.getUsername(),
Pwd:CM.getPassword()},function(a){var e=$("#contacts_list"),g=e[0];Common.clearList(g);if(a.sp_GetAnagResult){for(var a=a.sp_GetAnagResult,d=0;d<a.length;d++){var b=a[d].tel1[0].Text.trim(),c=a[d].mail[0].Text.trim();b&&c&&(b+=" - ");(b+=c)||(b="-");Common.addListItem(g,{text:a[d].Nominativo[0].Text+" ("+a[d].Code[0].Text+")",subText:b,href:"javascript:Contacts.showDetail('"+a[d].IDAnag[0].Text+"')"})}e.listview("refresh")}Common.hideLoading()},Common.wcfError)};Contacts.showDetail=function(a,e,g){Common.showLoading();
Common.initTables(null,["objAnag","assignments"],function(){N2WcfClient.invoke("GetAnagDett",{IDAnag:a,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(d){N2WcfClient.invoke("GetCateg",{IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(b){var c=Util.x2jXmlToObj(d.Main[0].sp_GetAnagMainResult[0]);Contacts.current.id=c.IDAnag;Contacts.current.code=c.Code;Contacts.current.originalMain=
c;Contacts.current.modified=!1;Contacts.current.phones={};var a=d.Phones[0].sp_GetAnagPhonesResult;if(a)for(var f=0;f<a.length;f++)Contacts.current.phones[a[f].IDPhone[0].Text]={id:a[f].IDPhone[0].Text,value:a[f].Num[0].Text,text:a[f].Text[0].Text,ord:Util.toInt(a[f].Ord[0].Text,0),deleted:!1};Contacts.current.emails={};if(a=d.Email[0].sp_GetAnagEmailResult)for(f=0;f<a.length;f++)Contacts.current.emails[a[f].IDEmail[0].Text]={id:a[f].IDEmail[0].Text,value:a[f].Address[0].Text,text:a[f].Text[0].Text,
ord:Util.toInt(a[f].Ord[0].Text,0),deleted:!1};Contacts._initCategories(b,d);Contacts.current.objAnag={};if(b=d.ObjAnag[0].sp_GetAnagObjAnagResult)for(f=0;f<b.length;f++)a=b[f].IDObj[0].Text,Contacts.current.objAnag[a]||(Contacts.current.objAnag[a]={id:a,code:b[f].Code[0].Text,type:String.fromCharCode(b[f].Tipo[0].Text),builder:b[f].Builder[0].Text,model:b[f].Model[0].Text,year:b[f].YearBuilt[0].Text,length:Util.toFloat(b[f].Lenght[0].Text,0),engine:b[f].Motorizzazione[0].Text,price:Util.toFloat(b[f].SellPrice[0].Text),
idAssignment:Util.toInt(b[f].IDAssignment[0].Text),availability:b[f].Availability[0].Text,categs:{}}),Contacts.current.objAnag[a].categs[b[f].IDObjAnagCateg[0].Text]=b[f].IDObjAnag[0].Text;$("#contact_detail").find("input[type='text'],textarea").val("");$("#contact_detail ul[data-empty-on-reset='true']").each(function(){Common.clearList(this)});b=c.Surname;"1"==c.Type?($("#contact_type_person").checked(!0),$("#contact_name_legalform").val(c.Name),$("#contact_title_vatcode").val(c.Title),b+=" "+c.Name):
($("#contact_type_company").checked(!0),$("#contact_name_legalform").val(c.LegalForm),$("#contact_title_vatcode").val(c.FiscCode),b+=" "+c.LegalForm);$("#contact_surname").val(c.Surname);$("#contact_company").val(c.Company);$("#contact_position").val(c.Position);$("#contact_text").val(c.Text);b+=" ("+c.Code+")";$("#contact_title").text(b);b=$("#contact_phones_listview");b.empty();for(var j in Contacts.current.phones)(c=Contacts.current.phones[j].text)&&(c=" ("+c+")"),c=Contacts.current.phones[j].value+
c,Common.addListItem(b[0],{text:c,href:"#",onclick:Contacts.handlers.modifyListItem_Click,data:Contacts.current.phones[j],cloneData:!0,splitText:"Remove",splitOnclick:Contacts.handlers.removeListItem_Click});b.refresh();b=$("#contact_emails_listview");b.empty();for(j in Contacts.current.emails)(c=Contacts.current.emails[j].text)&&(c=" ("+c+")"),c=Contacts.current.emails[j].value+c,Common.addListItem(b[0],{text:c,href:"#",onclick:Contacts.handlers.modifyListItem_Click,data:Contacts.current.emails[j],
cloneData:!0,splitText:"Remove",splitOnclick:Contacts.handlers.removeListItem_Click});b.refresh();Common.multipleChoiceDialog.updateListview($("#contact_categories_listview"),Contacts.current.categories);f=$("#contact_obj_anag_listview");f.empty();for(j in Contacts.current.objAnag){b=Contacts.current.objAnag[j];a=["M","V","G"].contains(b.type);c=b.builder+" "+b.model;c=c.trim();b.year&&(c+=" ("+b.year+")");var k=[];a&&k.push("<a>");k.push("<p><b>"+c+"</b></p>");a&&k.push("<p>"+Util.numberToString(b.length)+
" Mt"+Util.htmlEscape(b.engine?" - "+b.engine:"")+"</p>");k.push("<p>"+Transl("AnagDettGridAssociazioniCode","Boat Code")+": <b>"+b.code+"</b></p>");b.idAssignment&&k.push("<p>"+Transl("ObjGridMandato","Mandate")+": <b>"+Common.tables.assignments[b.idAssignment]+"</b></p>");b.price&&k.push("<p>"+Transl("ObjGridPrezzo","Price")+": <b>\u20ac "+Util.numberToStringThousSep(b.price)+"</b></p>");b.availability&&k.push("<p>"+Transl("ObjGridDisp","Availability")+": <b>"+Util.ISODateToString(b.availability)+
"</b></p>");var c=[],o;for(o in b.categs)"deleted"!==o&&c.push(Common.tables.objAnag.categories[o]);c.length&&k.push("<p>"+Transl("AnagDettGridAssociazioniCateg","Role")+": <b>"+c.join(", ")+"</b></p>");a?(k.push("</a>"),c=$(k.join("")),c.click(Contacts.handlers.objAnag_Click)):c=k.join("");Common.addListItem(f[0],{html:c,data:b})}f.refresh();$.isEmptyObject(Contacts.current.objAnag)?f.closest("li").addClass("ui-screen-hidden").parent().refresh():f.closest("li").removeClass("ui-screen-hidden").parent().refresh();
Contacts.handlers.contactType_Changed();$("#contact_detail").off("change",Contacts.handlers.element_Changed).on("change",Contacts.handlers.element_Changed);g||(Contacts.backOptions=null);$(".contact_back").btnText(Contacts.backOptions?Contacts.backOptions.text:Transl("AnagContacts","Contacts"));Common.changePage("contact_detail","slide",e)},Common.wcfError)},Common.wcfError)})};Contacts.create=function(){Common.checkInsertUserLimit("Anag",!0,function(){Common.initTables(null,["objAnag","assignments"],
function(){N2WcfClient.invoke("GetCateg",{IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){Contacts.current.id=null;Contacts.current.code=null;Contacts.current.originalMain=null;Contacts.current.modified=false;Contacts.current.phones={};Contacts.current.emails={};Contacts._initCategories(a);Contacts.current.objAnag={};$("#contact_detail").find("input[type='text'],textarea").val("");$("#contact_detail ul[data-empty-on-reset='true']").each(function(){Common.clearList(this)});
$("#contact_title").text(Transl("AnagDettTitle","New Card"));$("#contact_categories_listview li").remove();$("#contact_type_person").checked(true);Contacts.handlers.contactType_Changed();$("#contact_obj_anag_listview").closest("li").addClass("ui-screen-hidden").parent().refresh();$("#contact_detail").off("change",Contacts.handlers.element_Changed).on("change",Contacts.handlers.element_Changed);Contacts.backOptions=null;$(".contact_back").btnText(Transl("AnagContacts","Contacts"));Common.changePage("contact_detail",
"slide")},Common.wcfError)})})};Contacts._initCategories=function(a,e){Contacts.current.categories={};if(a.Categories&&1==a.Categories.length){var g=a.Categories[0].AnagCategory;if(g)for(var d=0;d<g.length;d++)Contacts.current.categories[g[d].IDCateg[0].Text]={id:g[d].IDCateg[0].Text,text:g[d].Text[0].Text,idLink:"",selected:!1}}if(e&&(g=e.CategAnag[0].sp_GetAnagCategResult))for(d=0;d<g.length;d++){var b=Contacts.current.categories[g[d].IDCateg[0].Text];b&&(b.idLink=g[d].IDCategAnag[0].Text,b.selected=
!0)}};Contacts.closeCurrent=function(){Contacts.current.modified?Common.confirm(Transl("OBMessageBoxText","Canceling now will make edited data NOT to be saved."),Contacts._back):Contacts._back(!1)};Contacts._back=function(a){Contacts.backOptions?(Contacts.backOptions.callback.apply(this,Contacts.backOptions.params),Contacts.backOptions=null):(Contacts.showList(!0),a&&Contacts.handlers.search_Click())};Contacts.saveCurrent=function(a){var e=null===Boats.current.code;Common.checkInsertUserLimit("Anag",
e,function(g){var d=$("#contact_type_person")[0].checked,b=$("#contact_surname").val(),c=Util.normalizeEndLines($("#contact_text").val());if(b)if(4E3<c.length)Common.alert(Transl("AnagDettSaveNotesExceedsLimit",'The "Notes" field exceeds the limit of characters allowed.'));else{Common.showLoading(Transl("MainSaving","Saving."));var h=null,f=new Date,j=[];e?Contacts.current.id=Util.createNewGuid():h=Contacts.current.originalMain;for(var k=[],o=$("#contact_phones_listview > li"),l=0;l<o.length;l++){var i=
$.data(o[l],"dataObj"),m=""===i.id?null:Contacts.current.phones[i.id];if(!m||i.text!==m.text||i.value!==m.value||i.ord!==l+1)k.push({IDPhone:""===i.id?Util.createNewGuid():i.id,IDAnag:Contacts.current.id,Text:i.text,Num:i.value,TranslationID:null,Ord:l+1})}for(var n in Contacts.current.phones)Contacts.current.phones[n].deleted&&j.push(Common.createDelete(n,"Phones"));o=[];i=$("#contact_emails_listview > li");for(l=0;l<i.length;l++){var m=$.data(i[l],"dataObj"),p=""===m.id?null:Contacts.current.emails[m.id];
if(!p||m.text!==p.text||m.value!==p.value||m.ord!==l+1)o.push({IDEmail:""===m.id?Util.createNewGuid():m.id,IDAnag:Contacts.current.id,Text:m.text,Address:m.value,TranslationID:null,Ord:l+1})}for(n in Contacts.current.emails)Contacts.current.emails[n].deleted&&j.push(Common.createDelete(n,"Email"));l=[];for(n in Contacts.current.categories)i=Contacts.current.categories[n],""===i.idLink&&i.selected?l.push({IDCategAnag:Util.createNewGuid(),IDAnag:Contacts.current.id,IDCateg:n}):""!==i.idLink&&!i.selected&&
j.push(Common.createDelete(i.idLink,"CategAnag"));n=[];e&&n.push({IDPermissionInternal:Util.createNewGuid(),IDObj:Contacts.current.id,UniqueID:CM.getUniqueID(),Modify:!0,IDGroup:CM.getIDGroup()});c={Guid:Contacts.current.id,Main:{$xmlns:"a:digibusinessNavisItems",IDAnag:Contacts.current.id,Code:e?0:Boats.current.code,Type:d?1:2,Surname:Util.emptyStringTo(b),Name:Util.emptyStringTo(d?$("#contact_name_legalform").val():null),Title:Util.emptyStringTo(d?$("#contact_title_vatcode").val():null),FiscCode:Util.emptyStringTo(d?
e?null:h.FiscCode:$("#contact_title_vatcode").val()),LegalForm:Util.emptyStringTo(d?null:$("#contact_name_legalform").val()),BirthDate:Util.emptyStringTo(e?null:h.BirthDate),IDBirthPlace:Util.emptyStringTo(e?null:h.IDBirthPlace),Sex:Util.emptyStringTo(e?null:h.Sex),Text:Util.emptyStringTo(c),FirstContact:Util.emptyStringTo(e?null:h.FirstContact),FirstContactWho:Util.emptyStringTo(e?null:h.FirstContactWho),FirstContactDate:Util.emptyStringTo(e?null:h.FirstContactDate),CanSpendFrom:Util.emptyStringTo(e?
null:h.CanSpendFrom),CanSpendTo:Util.emptyStringTo(e?null:h.CanSpendTo),CanSpendCurrency:Util.emptyStringTo(e?null:h.CanSpendCurrency),Turnover:Util.emptyStringTo(e?null:h.Turnover),Evid:Util.emptyStringTo(e?!1:h.Evid,!1),Company:Util.emptyStringTo($("#contact_company").val()),Position:Util.emptyStringTo($("#contact_position").val()),InsUser:e?CM.getIDUser():h.InsUser,UpdUser:CM.getIDUser(),InsDate:e?f:h.InsDate,UpdDate:f,IDGroup:CM.getIDGroup(),TranslationID:null,CRMList:e?!1:h.CRMList,InternalPermission:e?
100:h.InternalPermission,EmailInbox:e?!0:h.EmailInbox,Newsletter:e?!1:h.Newsletter},Addresses:{$xmlns:"a:digibusinessNavisItems"},Email:{$xmlns:"a:digibusinessNavisItems",sp_GetAnagEmailResult:o},Phones:{$xmlns:"a:digibusinessNavisItems",sp_GetAnagPhonesResult:k},URL:{$xmlns:"a:digibusinessNavisItems"},Banks:{$xmlns:"a:digibusinessNavisItems"},NavZone:{$xmlns:"a:digibusinessNavisItems"},IDDocs:{$xmlns:"a:digibusinessNavisItems"},CategAnag:{$xmlns:"a:digibusinessNavisItems",sp_GetAnagCategResult:l},
Categ:{$xmlns:"a:digibusinessNavisItems"},IMs:{$xmlns:"a:digibusinessNavisItems"},CRM:{$xmlns:"a:digibusinessNavisItems"},Docs:{$xmlns:"a:digibusinessNavisItems"},IntMod:{$xmlns:"a:digibusinessNavisItems"},AssociazioniObjAnag:{$xmlns:"a:digibusinessNavisItems"},AssociazioniObjAnagCateg:{$xmlns:"a:digibusinessNavisItems"},Followers:{$xmlns:"a:digibusinessNavisItems"},CharterZones:{$xmlns:"a:digibusinessNavisItems"},CharterQualifications:{$xmlns:"a:digibusinessNavisItems"},CharterQualificationsNames:{$xmlns:"a:digibusinessNavisItems"},
CharterAvailabilities:{$xmlns:"a:digibusinessNavisItems"},PermissionInternal:{$xmlns:"a:digibusinessNavisItems",sp_GetPermissionInternalResult:n},DeletedRecords:{Delete:j},DeletedFiles:""};d?(c.Main.Title&&(b=c.Main.Title+" "+b),c.Main.Name&&(b+=" "+c.Main.Name)):c.Main.LegalForm&&(b+=" "+c.Main.LegalForm);N2WcfClient.insertIntoQueue({body:c,bodyType:"Anag",guid:c.Main.IDAnag,descr:b,priority:"High"},function(){setTimeout(function(){Common.checkInsertUserLimitOnSavedItem(e,g,function(){a?a():Contacts._back(!e)})},
3E3)},Common.wcfError,CM.getIDUser(),CM.getIDGroup(),CM.getGuidUser(),CM.getUsername(),CM.getPassword())}else d?Common.alert(Transl("AnagDettSaveEnterSurname","You must enter the surname before saving.")):Common.alert(Transl("AnagDettSaveEnterCompany","You must enter the company name before saving."))})};Contacts.handlers.element_Changed=function(){Contacts.current.modified=!0;$("#contact_detail").off("change",Contacts.handlers.element_Changed)};$("#contact_detail").on("pageshow",function(){Common.textareaAutoSize($("#contact_text").height(250))});
Contacts.handlers.contactType_Changed=function(){$("#contact_type_person").checked()?($("label[for='contact_surname']").text(Transl("AnagDettCognome","Last name")),$("label[for='contact_name_legalform']").text(Transl("AnagDettNome","Name")),$("label[for='contact_title_vatcode']").text(Transl("AnagDettTitolo","Title"))):($("label[for='contact_surname']").text(Translations.get("AnagDettRagSoc","Company name")),$("label[for='contact_name_legalform']").text(Transl("AnagDettFormLeg","Legal form")),$("label[for='contact_title_vatcode']").text(Transl("AnagDettPIva",
"VAT number")))};Contacts.handlers.modifyListItem_Click=function(){var a=$(this).closest("li");Contacts._showListItemDetail(a.closest("ul"),a)};Contacts.handlers.removeListItem_Click=function(){var a=$(this).closest("li"),e=a.find("> .ui-li > .ui-btn-text > .ui-link-inherit > span").text();Common.confirm(Transl("MainDelete","Are you sure you want to delete {0}?").format('"'+e+'"'),function(){var e=a.parent(),d=a.data("dataObj");""!=d.id&&("contact_phones_listview"==e.attr("id")?Contacts.current.phones[d.id].deleted=
!0:Contacts.current.emails[d.id].deleted=!0);a.remove();e.refresh().change()})};Contacts.handlers.addPhone_Click=function(){Contacts._showListItemDetail($("#contact_phones_listview"))};Contacts.handlers.addEmail_Click=function(){Contacts._showListItemDetail($("#contact_emails_listview"))};Contacts.handlers.modifyCategories_Click=function(){Common.multipleChoiceDialog.show({title:Transl("AnagDettChooseCategories","Choose categories"),choices:Contacts.current.categories,listview:$("#contact_categories_listview")})};
Contacts.handlers.objAnag_Click=function(){var a=$(this).closest("li").dataObj(),e={text:Transl("MainBack","Back"),callback:Contacts.showDetail,params:[Contacts.current.id,!0,!0]};Contacts.current.modified?Common.confirm(Transl("AnagDettSaveToOpenBoat","You need to save your changes to open the boat."),function(){Contacts.saveCurrent(function(){Contacts.backOptions&&Boats.backOptions&&(Contacts.backOptions=null);Boats.backOptions=e;Boats.showDetail(a.id,a.type,null,!1,!0)})}):(Contacts.backOptions&&
Boats.backOptions&&(Contacts.backOptions=null),Boats.backOptions=e,Boats.showDetail(a.id,a.type,null,!1,!0))};Contacts._showListItemDetail=function(a,e){var g=$("label[for='contact_listitem_value']"),d=$("#contact_listitem_detail div[data-role='header'] h1");"contact_phones_listview"==a.attr("id")?(g.text(Transl("AnagTelefono","Phone")),d.text(e?Transl("AnagDettEditPhone","Edit phone"):Transl("AnagDettAddPhone","Add phone"))):(g.text(Translations.get("AnagMail")||"Email"),d.text(e?Transl("AnagDettEditEmail",
"Edit email"):Transl("AnagDettAddEmail","Add email")));e?(g=e.data("dataObj"),$("#contact_listitem_value").val(g.value),$("#contact_listitem_description").val(g.text)):$("#contact_listitem_value,#contact_listitem_description").val("");$("#contact_listitem_detail").data("dataObj",{li:e,listview:a});Common.changePage("contact_listitem_detail","pop")};Contacts.handlers.dialogCancel_Click=function(){Common.changePage("contact_detail","pop",!0)};Contacts.handlers.listitemDetailOK_Click=function(){var a=
$("#contact_listitem_value").val().trim(),e=$("#contact_listitem_description").val().trim(),g=$("#contact_listitem_detail").data("dataObj"),d="contact_phones_listview"==g.listview[0].id,b=d?Common.phoneRegex:Common.emailRegex;if(!a||!b.test(a))d?Common.alert(Transl("AnagDettPhoneNotValid","The phone {0} is not valid.").format('"'+a+'"')):Common.alert(Transl("SendMailEmailNotValid","The email {0} is not valid.").format('"'+a+'"'));else{d=g.li?g.li.data("dataObj"):{};if(!g.li||d.value!==a||d.text!==
e)d.value=a,d.text=e,a=d.value+(d.text?" ("+d.text+")":""),g.li?g.li.find("> .ui-li > .ui-btn-text > .ui-link-inherit > span").text(a):(d.id="",d.ord=0,d.deleted=!1,Common.addListItem(g.listview[0],{text:a,href:"#",onclick:Contacts.handlers.modifyListItem_Click,data:d,splitText:"Remove",splitOnclick:Contacts.handlers.removeListItem_Click})),g.listview.refresh().change();Common.changePage("contact_detail","pop",!0)}}});



var Common={pdfViewer:{back:null},chooseFromTextDialog:{table:null,type:null,idFather:null,success:null,preloadResults:null,popup:null,handlers:{}},multipleChoiceDialog:{choices:null,selectedChoices:null,listview:null,li:null,updateLi:null,emptyChoiceAlert:null,handlers:{}},chooseCustomerDialog:{success:null,handlers:{}},tables:{conditions:null,navCats:null,hullShapes:null,assignments:null,vat:null,materials:null,colours:null,transmissions:null,enginesBuilders:null,currencies:null,users:null,keels:null,
ballasts:null,starters:null,inflKeels:null,driveTypes:null,objTypes:{M:null,V:null,G:null,E:null},objLayoutLevels:{M:null,V:null,G:null},objLayoutComponents:{M:null,V:null,G:null},objLayoutComponentsCategories:{accomodations:[7,8,9,10,11,12,13,14,15,16,19,23,232,234,235],surfaceMq:[220,221,222,223,224,225],heightM:[226]},objLayoutComponentsAccomodations:{1:[13,16],2:[8,9,10,11,12,232,234,235],3:[14],4:[15]},objAccessories:{M:null,V:null,G:null},objAnag:{defaultCategory:null,categories:null},userSettings:{pubblishAttr:{Web:null,
Vet:null,Evi:null,ADB:null,AM:null,BI:null,BAG:null,B24:null,BS:null,BR:null,CDB:null,EYB:null,MB:null,NI:null,PB:null,SM:null,TYM:null,TOP:null,TB:null,YA:null,YB:null,Riv:null},limits:{imagesCount:null,imagesBytes:5242880}}},dialogBackPage:null,dialogBackPageScroll:null,emailRegex:/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,phoneRegex:/^(\+)?\d((\s){0,2}\d){5,15}$/,iScrollContainer:{},handlers:{}};
$(document).on("appready",function(){var a=$("input:text[data-type='date']");App.platform.iOS&&5<=App.platform.version.major?(a.each(function(){this.setAttribute("type","date")}),a.attr("min","1753-01-01").attr("max","9999-12-31")):a.attr("placeholder","gg/mm/aaaa");a.on("blur",Common.handlers.dataTypeDate_Blur);$("input:text[data-type='number']").on("change",Common.handlers.dataTypeNumber_Change);$("#choose_dialog").on("pageshow",Common.chooseFromTextDialog.handlers.dialog_PageShow);$("#choose_customer").on("pageshow",
Common.chooseCustomerDialog.handlers.dialog_PageShow);$(".popup_dialog").on("popupafterclose",function(){$(this).removeDataObj()});$(".popup_dialog .close_btn").on("click",function(){$(this).closest(".popup_dialog").popup("close")});$(".popup_dialog.navispost .yes_btn").on("click",function(){Common.openLink(Registration.serviceUrl+Translations.currentCultureName.substr(0,2)+"/NavisPOST");$(this).closest(".popup_dialog").popup("close")})}).on("selectmenucreate",function(a){a=$(a.target);if(a.is("[data-role='selectbutton']")){var b=
a.attr("data-translation");a.prop("selectedIndex",-1).parent().find(".ui-btn-inner span:first").text(Transl(b)).attr("class","").attr("data-translation",b);a.on("change",function(){var a=$(this);setTimeout(function(){a.prop("selectedIndex",-1)},0)})}});
Common.pdfViewer.show=function(a){pdf_link="";$.each("group_id obj_id obj_type boat_code print_type num_header id_sede download culture".split(" "),function(b,c){if(a[c]!==void 0){pdf_link!==""&&(pdf_link=pdf_link+"&");var e=a[c],e=$.type(e)=="boolean"?e?"1":"0":escape(e.toString());pdf_link=pdf_link+(c+"="+e)}});pdf_link="http://app2.digibusiness.it/naviswebprint/print.aspx?"+pdf_link;if(App.platform.iOS){Common.pdfViewer.back=a.back||null;Common.pdfViewer.back?(Common.dialogBackPage=null,Common.dialogBackPageScroll=
null):(Common.dialogBackPage=$.mobile.activePage,Common.dialogBackPageScroll=$(window).scrollTop());$("#pdf_viewer_back").btnText(a.backText||Transl("MainBack","Back"));$("#pdf_viewer .header h2").html(a.header||"");$("#pdf_viewer_open_in_safari").attr("href",pdf_link);var b="http://docs.google.com/viewer?url="+escape(pdf_link)+"&embedded=true";$("#pdf_viewer_iframe_div").html('<iframe src="'+b+'"></iframe>');Common.changePage("pdf_viewer","slide")}else window.open(pdf_link)};
Common.pdfViewer._close=function(){$("#pdf_viewer_iframe_div").html("");Common.pdfViewer.back?"string"==typeof Common.pdfViewer.back?Common.changePage(Common.pdfViewer.back,"slide",!0):Common.pdfViewer.back():Common._closeDialog("slide")};
Common.chooseFromTextDialog.show=function(a,b,d,c,e,f,g){Common.chooseFromTextDialog.table=b;Common.chooseFromTextDialog.type=d;Common.chooseFromTextDialog.idFather=c;Common.chooseFromTextDialog.success=e;Common.chooseFromTextDialog.preloadResults=f;g?(Common.chooseFromTextDialog.popup=$(g),Common.dialogBackPage=null,Common.dialogBackPageScroll=null):(Common.chooseFromTextDialog.popup=null,Common.dialogBackPage=$.mobile.activePage,Common.dialogBackPageScroll=$(window).scrollTop());var h=Common.chooseFromTextDialog.popup||
$("#choose_dialog");h.find(".choose_dialog_title").text(a);h.find(".choose_dialog_txt").uiVal("");Common.clearList(h.find(".choose_dialog_list")[0]);Common.clearList(h.find(".choose_dialog_list_filter")[0]);f?Common.chooseFromTextDialog.search(null,function(){h.find(".choose_dialog_on_demand_results").css("display","none");h.find(".choose_dialog_preload_results").css("display","");Common.chooseFromTextDialog.popup?Common.chooseFromTextDialog.popup.popup("open"):Common.changePage("choose_dialog","pop")}):
(h.find(".choose_dialog_on_demand_results").css("display",""),h.find(".choose_dialog_preload_results").css("display","none"),Common.chooseFromTextDialog.popup?Common.chooseFromTextDialog.popup.popup("open"):Common.changePage("choose_dialog","pop"))};
Common.chooseFromTextDialog.search=function(a,b){Common.showLoading();N2WcfClient.invoke("GetListFromText",{Table:Common.chooseFromTextDialog.table,Text:a,Type:Common.chooseFromTextDialog.type?Common.chooseFromTextDialog.type.charCodeAt(0):null,IDFather:Common.chooseFromTextDialog.idFather,Culture:Translations.currentCultureName,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){var c=(Common.chooseFromTextDialog.popup||$("#choose_dialog")).find(Common.chooseFromTextDialog.preloadResults?
".choose_dialog_list_filter":".choose_dialog_list"),e=c[0];Common.clearList(e);if(a.sp_GetListFromTextResult)for(var a=a.sp_GetListFromTextResult,f=0;f<a.length;f++){var g={id:a[f].ID[0].Text,text:a[f].Text[0].Text};Common.addListItem(e,{text:g.text,onclick:Common.chooseFromTextDialog.handlers.listItem_Click,data:g})}c.refresh();Common.hideLoading();b&&b()},Common.wcfError)};Common.chooseFromTextDialog.handlers.dialog_PageShow=function(){Common.focusToField("choose_dialog_txt")};
Common.chooseFromTextDialog.handlers.search_Click=function(){var a=(Common.chooseFromTextDialog.popup||$("#choose_dialog")).find(".choose_dialog_txt").uiVal();3<=a.length&&Common.chooseFromTextDialog.search(a)};Common.chooseFromTextDialog.handlers.listItem_Click=function(){Common.chooseFromTextDialog.success($(this).closest("li").dataObj());Common.chooseFromTextDialog.popup?Common.chooseFromTextDialog.popup.popup("close"):Common._closeDialog()};
Common.multipleChoiceDialog.show=function(a){$("#choices_dialog_title").text(a.title||"");Common.multipleChoiceDialog.choices=a.choices;Common.multipleChoiceDialog.selectedChoices=a.selectedChoices||null;Common.multipleChoiceDialog.listview=a.listview||null;Common.multipleChoiceDialog.li=a.li||null;Common.multipleChoiceDialog.updateLi=a.updateLi||null;Common.multipleChoiceDialog.emptyChoiceAlert=a.emptyChoiceAlert||null;var b=$("#choices_dialog_controlgroup");b.empty();for(var d in a.choices){var c=
a.choices[d],e=a.selectedChoices?c:c.text||c.ref.text||"",f=document.createElement("input");f.setAttribute("type","checkbox");f.setAttribute("name","checkbox_choices");f.setAttribute("id","checkbox_choice_"+d);f.setAttribute("data-id",d);f.checked=a.selectedChoices?d in a.selectedChoices:c.selected;c=document.createElement("label");c.setAttribute("for","checkbox_choice_"+d);c.appendChild(document.createTextNode(e));b.append(f).append(c)}b.find("input:checkbox").checkboxradio();b.controlgroup({excludeInvisible:!1});
Common.dialogBackPage=$.mobile.activePage;Common.dialogBackPageScroll=$(window).scrollTop();Common.changePage("choices_dialog","pop")};Common.multipleChoiceDialog.updateListview=function(a,b,d){a.empty();if(d)for(var c in d)"deleted"!==c&&a.append($("<li></li>").text(b[c]));else for(c in b)d=b[c],d.selected&&a.append($("<li></li>").text(d.text||d.ref.text||""));a.refresh()};
Common.multipleChoiceDialog.handlers.btnOK_Click=function(){if(Common.multipleChoiceDialog.emptyChoiceAlert&&0==$("#choices_dialog_controlgroup input:checkbox:checked:first").length)Common.alert(Common.multipleChoiceDialog.emptyChoiceAlert);else{var a=!1;if(Common.multipleChoiceDialog.selectedChoices)a=Common.multipleChoiceDialog.updateSelectedChoices($("#choices_dialog_controlgroup"),Common.multipleChoiceDialog.selectedChoices);else for(var b in Common.multipleChoiceDialog.choices){var d=Common.multipleChoiceDialog.choices[b],
c=document.getElementById("checkbox_choice_"+b).checked;d.selected!==c&&(d.selected=c,a=!0)}if(a&&(Common.multipleChoiceDialog.listview||Common.multipleChoiceDialog.li))Common.multipleChoiceDialog.listview?(Common.multipleChoiceDialog.updateListview(Common.multipleChoiceDialog.listview,Common.multipleChoiceDialog.choices),Common.multipleChoiceDialog.listview.change()):Common.multipleChoiceDialog.li&&(Common.multipleChoiceDialog.updateLi(Common.multipleChoiceDialog.li),Common.multipleChoiceDialog.li.parent().refresh().change());
Common._closeDialog()}};Common.multipleChoiceDialog.initControlgroup=function(a,b,d){a.empty();for(var c in d)a.append('<input type="checkbox" name="'+b+'" id="'+b+"_"+c+'" data-id="'+c+'"></input>',$('<label for="'+b+"_"+c+'"></label>').text(d[c]));a.find("input:checkbox").checkboxradio();a.controlgroup({excludeInvisible:!1})};Common.multipleChoiceDialog.updateControlgroup=function(a,b){a.find("input:checkbox").each(function(){var a=$(this);a.checked(void 0!==b[a.attr("data-id")])})};
Common.multipleChoiceDialog.updateSelectedChoices=function(a,b){var d=!1;a.find("input:checkbox").each(function(){var a=$(this),e=a.attr("data-id");a.checked()?void 0===b[e]&&(b.deleted&&b.deleted[e]?(b[e]=b.deleted[e],delete b.deleted[e],$.isEmptyObject(b.deleted)&&delete b.deleted):b[e]=null,d=!0):void 0!==b[e]&&(b[e]&&(b.deleted||(b.deleted={}),b.deleted[e]=b[e]),delete b[e],d=!0)});return d};
Common.chooseCustomerDialog.show=function(a){Common.chooseCustomerDialog.success=a;Common.dialogBackPage=$.mobile.activePage;Common.dialogBackPageScroll=$(window).scrollTop();$("#choose_customer_list li").remove();$("#choose_customer_txt").val("");Common.changePage("choose_customer","pop")};Common.chooseCustomerDialog.handlers.dialog_PageShow=function(){Common.focusToField("choose_customer_txt")};
Common.chooseCustomerDialog.handlers.search_Click=function(){var a=$("#choose_customer_txt").val();3<=a.length&&(Common.showLoading(),N2WcfClient.invoke("GetAnagFromString",{String:a,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){var d=$("#choose_customer_list"),c=d[0];Common.clearList(c);if(a.sp_GetAnagFromStringResult)for(var a=a.sp_GetAnagFromStringResult,e=0;e<a.length;e++){var f={id:a[e].IDAnag[0].Text,code:Util.toInt(a[e].Code[0].Text,
0),name:a[e].Nominativo[0].Text,title:a[e].Title[0].Text};Common.addListItem(c,{text:a[e].Nominativo[0].Text,onclick:Common.chooseCustomerDialog.handlers.listItem_Click,data:f})}d.refresh();Common.hideLoading()},Common.wcfError))};Common.chooseCustomerDialog.handlers.listItem_Click=function(){Common.chooseCustomerDialog.success($(this).closest("li").dataObj());Common._closeDialog()};
Common._closeDialog=function(a){Common.dialogBackPage.one("pageshow",function(){$(window).scrollTop(Common.dialogBackPageScroll)});Common.changePage(Common.dialogBackPage,a||"pop",!0)};Common.wcfError=function(a,b,d){Common.hideLoading();$.mobile.isPageInitialized||($.mobile.initializePage(),$("#loading").remove(),$.mobile.isPageInitialized=!0);console.log(d);Common.alert(Transl("MainCommErr","Communication error. Check your internet connection and try again."))};
Common.alert=function(a,b,d,c){App.cordova?navigator.notification.alert(a,b,d||App.name,c):(alert(a),b&&b())};Common.confirm=function(a,b,d,c,e,f){App.cordova?(e=e||"OK",f=f||Transl("OBCancelButtonText","Cancel"),navigator.notification.confirm(a,function(a){2==a?b&&b():d&&d()},c||App.name,f+","+e)):confirm(a)?b&&b():d&&d()};Common.stopPropagation=function(a){a.stopPropagation()};Common.preventDefaultAndStopPropagation=function(a){a.preventDefault();a.stopPropagation()};
function SuccessFn(a,b){this.fn=a;this.thisObj=b}function InvokeList(){this.list=[];this.length=0}InvokeList.prototype.add=function(){this.list.push({method:arguments[0],params:Array.prototype.slice.call(arguments,1)});this.length++};InvokeList.prototype.clear=function(){this.list=[];this.length=0};
InvokeList.prototype.invokeAll=function(a){if(0===this.list.length)a();else{for(var b=this.list.shift(),d=0;d<b.params.length;d++)if(b.params[d]&&b.params[d].constructor==SuccessFn){var c=b.params[d].fn,e=b.params[d].thisObj,f=this;b.params[d]=function(){c&&c.apply(e||this,arguments);f.invokeAll(a)};break}b.method.apply(this,b.params)}};
Common.getTextFromID=function(){var a=arguments[arguments.length-1];N2WcfClient.invoke("GetTextFromID",{Table:2<=arguments.length?arguments[0]:null,ID:3<=arguments.length?arguments[1]:null,Culture:Translations.currentCultureName,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(b){var d="";b&&b.Text&&(d=b.Text[0].Text);a(d)},Common.wcfError)};
Common.getListFromText=function(){var a=4<=arguments.length?arguments[2]:null,b=5<=arguments.length?arguments[3]:null,d=arguments[arguments.length-1];N2WcfClient.invoke("GetListFromText",{Table:2<=arguments.length?arguments[0]:null,Text:3<=arguments.length?arguments[1]:null,Type:"string"==typeof a?a.charCodeAt(0):a,IDFather:b,Culture:Translations.currentCultureName,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){var b=[];if(a.sp_GetListFromTextResult)for(var a=
a.sp_GetListFromTextResult,f=0;f<a.length;f++)b.push({id:a[f].ID[0].Text,text:a[f].Text[0].Text});d(b)},Common.wcfError)};Common.translate=function(a,b,d,c){N2WcfClient.invoke("Translate",{Text:a,From:b,To:d,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){if(void 0===a.Text)throw Error("Translate function error: translation is not defined.");c(a.Text)},Common.wcfError)};
Common.checkInsertUserLimit=function(a,b,d){N2WcfClient.invoke("GetRemainingItemsToInsert",{Table:a,IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},function(a){a=Util.toInt(a.Text,0,-1);b&&0===a?(Common.hideLoading(),a=$.mobile.activePage.find(".popup_dialog.navispost"),a.find("> .ui-content > p").html(Transl("MainFreeUserLimitReachedNew","To be able to insert other elements you need to have NavisPOST, the cloud solution of the suite Navis.net (www.navisnet.it), synchronized with Yachts For Sale.\nDo you want to know more about NavisPOST?").replace(/\n/g,
"<br />")),a.popup("open")):d(a)},Common.wcfError)};
Common.checkInsertUserLimitOnSavedItem=function(a,b,d){if(!a&&0===b||a&&1===b)$(document).one("pageshow",function(a){a=$(a.target).find(".popup_dialog.navispost");a.find("> .ui-content > p").html(Transl("MainFreeUserLimitReachedSaved","Item successfully saved.\nTo be able to insert other elements you need to have NavisPOST, the cloud solution of the suite Navis.net (www.navisnet.it), synchronized with Yachts For Sale.\nDo you want to know more about NavisPOST?").replace(/\n/g,"<br />"));a.popup("open")});
d()};
Common.initTables=function(a,b,d){var c=new InvokeList;if(!b||b.contains("objTypes"))a&&!Common.tables.objTypes[a]&&c.add(Common.getListFromText,"ObjTypes",null,a,new SuccessFn(function(b){Common.tables.objTypes[a]={};$.each(b,function(){Common.tables.objTypes[a][this.id]=this.text})})),Common.tables.objTypes.E||c.add(Common.getListFromText,"ObjTypes",null,"E",new SuccessFn(function(a){Common.tables.objTypes.E={};$.each(a,function(){Common.tables.objTypes.E[this.id]=this.text})}));a&&(!Common.tables.objLayoutLevels[a]&&(!b||
b.contains("objLayoutLevels")))&&c.add(Common.getListFromText,"Parts",null,a,"L",new SuccessFn(function(b){Common.tables.objLayoutLevels[a]={};$.each(b,function(){Common.tables.objLayoutLevels[a][this.id]=this.text})}));a&&(!Common.tables.objLayoutComponents[a]&&(!b||b.contains("objLayoutComponents")))&&c.add(Common.getListFromText,"Parts",null,a,"P",new SuccessFn(function(b){Common.tables.objLayoutComponents[a]={};$.each(b,function(){Common.tables.objLayoutComponents[a][this.id]=this.text})}));if(a&&
(!b||b.contains("objAccessories"))&&!Common.tables.objAccessories[a])for(var e=[],f=1;9>=f;f++)c.add(Common.getListFromText,"Parts",null,a,f,new SuccessFn(function(b){for(var c=0;c<b.length;c++)b[c].category=this.i;e.push(b);if(9==e.length){Common.tables.objAccessories[a]={};for(b=0;9>b;b++)for(c=0;c<e[b].length;c++)Common.tables.objAccessories[a][e[b][c].id]=e[b][c]}},{i:f}));!Common.tables.objAnag.categories&&(!b||b.contains("objAnag"))&&c.add(N2WcfClient.invoke,"GetObjAnagCateg",{IDUser:CM.getIDUser(),
Username:CM.getUsername(),Password:CM.getPassword(),IDGroup:CM.getIDGroup()},new SuccessFn(function(a){a=a.sp_GetObjAnagCategResult;Common.tables.objAnag.categories={};for(var b=0;b<a.length;b++)Common.tables.objAnag.categories[a[b].IDObjAnagCateg[0].Text]=a[b].Text[0].Text,"true"==a[b].IsMain[0].Text&&(Common.tables.objAnag.defaultCategory={id:a[b].IDObjAnagCateg[0].Text,text:a[b].Text[0].Text});if(!Common.tables.objAnag.defaultCategory)throw Error('defaultCategory is not defined. Check "IsMain" field in "GetObjAnagCateg"');
}),Common.wcfError);!Common.tables.conditions&&(!b||b.contains("conditions"))&&c.add(Common.getListFromText,"Conditions",new SuccessFn(function(a){Common.tables.conditions=a}));!Common.tables.navCats&&(!b||b.contains("navCats"))&&c.add(Common.getListFromText,"NavCats",new SuccessFn(function(a){Common.tables.navCats=a}));!Common.tables.assignments&&(!b||b.contains("assignments"))&&c.add(Common.getListFromText,"Assignments",new SuccessFn(function(a){Common.tables.assignments={};$.each(a,function(){Common.tables.assignments[this.id]=
this.text})}));!Common.tables.vat&&(!b||b.contains("vat"))&&c.add(Common.getListFromText,"VAT",new SuccessFn(function(a){Common.tables.vat={};$.each(a,function(){Common.tables.vat[this.id]=this.text})}));!Common.tables.materials&&(!b||b.contains("materials"))&&c.add(Common.getListFromText,"Materials",new SuccessFn(function(a){Common.tables.materials={};$.each(a,function(){Common.tables.materials[this.id]=this.text})}));!Common.tables.colours&&(!b||b.contains("colours"))&&c.add(Common.getListFromText,
"Colours",new SuccessFn(function(a){Common.tables.colours={};$.each(a,function(){Common.tables.colours[this.id]=this.text})}));!Common.tables.transmissions&&(!b||b.contains("transmissions"))&&c.add(Common.getListFromText,"Transmission",new SuccessFn(function(a){Common.tables.transmissions={};$.each(a,function(){Common.tables.transmissions[this.id]=this.text})}));!Common.tables.enginesBuilders&&(!b||b.contains("enginesBuilders"))&&c.add(Common.getListFromText,"Builders",null,"E",new SuccessFn(function(a){Common.tables.enginesBuilders=
a}));!Common.tables.currencies&&(!b||b.contains("currencies"))&&c.add(Common.getListFromText,"Currencies",new SuccessFn(function(a){Common.tables.currencies={};$.each(a,function(){Common.tables.currencies[this.id]=this.text})}));!Common.tables.users&&(!b||b.contains("users"))&&c.add(Common.getListFromText,"Users",new SuccessFn(function(a){Common.tables.users={};$.each(a,function(){Common.tables.users[this.id]=this.text})}));a&&("G"!=a&&!Common.tables.hullShapes&&(!b||b.contains("hullShapes")))&&c.add(Common.getListFromText,
"HullShapes",new SuccessFn(function(a){Common.tables.hullShapes=a}));switch(a){case "V":!Common.tables.keels&&(!b||b.contains("keels"))&&c.add(Common.getListFromText,"Keels",new SuccessFn(function(a){Common.tables.keels=a}));!Common.tables.ballasts&&(!b||b.contains("ballasts"))&&c.add(Common.getListFromText,"Ballasts",new SuccessFn(function(a){Common.tables.ballasts=a}));break;case "G":!Common.tables.starters&&(!b||b.contains("starters"))&&c.add(Common.getListFromText,"Starters",new SuccessFn(function(a){Common.tables.starters=
a})),!Common.tables.inflKeels&&(!b||b.contains("inflKeels"))&&c.add(Common.getListFromText,"InflKeels",new SuccessFn(function(a){Common.tables.inflKeels=a})),!Common.tables.driveTypes&&(!b||b.contains("driveTypes"))&&c.add(Common.getListFromText,"DriveTypes",new SuccessFn(function(a){Common.tables.driveTypes=a}))}null===Common.tables.userSettings.pubblishAttr.Web&&(!b||b.contains("userSettings"))&&c.add(N2WcfClient.invoke,"GetSettingsUser",{IDUser:CM.getIDUser(),Username:CM.getUsername(),Password:CM.getPassword(),
IDGroup:CM.getIDGroup()},new SuccessFn(function(a){for(var b in Common.tables.userSettings.pubblishAttr)Common.tables.userSettings.pubblishAttr[b]=!1;var c=a.PubblishAttr[0].sp_GetUserPubblishAttrResult;if(c)for(b=0;b<c.length;b++)null!==Common.tables.userSettings.pubblishAttr[c[b].IDPubblishAttr[0].Text]&&(Common.tables.userSettings.pubblishAttr[c[b].IDPubblishAttr[0].Text]=!0);if(a=a.Limit[0].sp_GetUserLimitResult)for(b=0;b<a.length;b++)if("2"==a[b].IDLimit[0].Text){Common.tables.userSettings.limits.imagesCount=
Util.toInt(a[b].Value[0].Text);break}}),Common.wcfError);c.invokeAll(d)};
Common.clearTables=function(){Common.tables.conditions=null;Common.tables.navCats=null;Common.tables.hullShapes=null;Common.tables.assignments=null;Common.tables.vat=null;Common.tables.materials=null;Common.tables.colours=null;Common.tables.transmissions=null;Common.tables.enginesBuilders=null;Common.tables.currencies=null;Common.tables.users=null;Common.tables.keels=null;Common.tables.ballasts=null;Common.tables.starters=null;Common.tables.inflKeels=null;Common.tables.driveTypes=null;Common.tables.objTypes.M=
null;Common.tables.objTypes.V=null;Common.tables.objTypes.G=null;Common.tables.objTypes.E=null;Common.tables.objLayoutLevels.M=null;Common.tables.objLayoutLevels.V=null;Common.tables.objLayoutLevels.G=null;Common.tables.objLayoutComponents.M=null;Common.tables.objLayoutComponents.V=null;Common.tables.objLayoutComponents.G=null;Common.tables.objAccessories.M=null;Common.tables.objAccessories.V=null;Common.tables.objAccessories.G=null;Common.tables.objAnag.categories=null;Common.tables.objAnag.defaultCategory=
null;for(var a in Common.tables.userSettings.pubblishAttr)Common.tables.userSettings.pubblishAttr[a]=null;Common.tables.userSettings.limits.imagesCount=null};Common.composeEngine=function(a,b,d,c,e){var f="";0<b?f+=a+" x "+b+" "+e:1<a&&(f+=a);if(d||c)0<f.length&&(f+=" "),d&&c?f+=d+" "+c:d?f+=d:c&&(f+=c);return f};Common.back=function(a){Common.changePage($.mobile.urlHistory.getPrev().url,a,!0)};
Common.changePage=function(a,b,d,c){var e="string"==typeof a;e&&/^(#)?\w+$/.test(a)&&(-1===a.indexOf("#")&&(a="#"+a),a=$(a),e=!1);$.mobile.isPageInitialized?(e?a=$.mobile.path.makeUrlAbsolute(a,$.mobile.getDocumentUrl(!0).hrefNoHash):a.removeData("title"),b||(b="fade"),d||(d=!1),e&&$.mobile.path.convertUrlToDataUrl(a)!==$.mobile.activePage.attr("data-url")||!e&&a[0]!==$.mobile.activePage[0]?$.mobile.changePage(a,{transition:b,reverse:d,role:c,changeHash:!1}):Common.hideLoading()):setTimeout(function(){a.prependTo("body");
$.mobile.initializePage();$("#loading").remove();$.mobile.isPageInitialized=true},100)};Common.showLoading=function(a,b,d){$.mobile.loading("show",{theme:d||$.mobile.loader.prototype.options.theme,text:a||$.mobile.loader.prototype.options.text,textonly:b?!0:!1,textVisible:a?!0:!1})};Common.hideLoading=function(){$.mobile.isPageInitialized&&$.mobile.loading("hide")};
Common.activateiScroll=function(a){var b=$(a).find("[data-role='content']");if(0<b.length){var d=b.children();b.hasClass("contentfooter")?d.hasClass("iscroll")||d.addClass("iscroll"):d.hasClass("iscrollnofooter")||d.addClass("iscrollnofooter");Common.iScrollContainer[a.id]?Common.iScrollContainer[a.id].refresh():Common.iScrollContainer[a.id]=new iScroll(b[0])}};Common.reset=function(a){a=a instanceof jQuery?a:$(a);a.find("[data-empty-on-reset='true']:not(input,textarea,select)").empty();Common.resetFormElements(a)};
Common.resetFormElements=function(a){var a=a instanceof jQuery?a:$(a),b;a.find("input:text,input:password,input[type='date'],input[type='email'],input[type='tel'],input[type='search'],textarea").not("[data-empty-on-reset='false']").uiVal("");a.find("input[type='number']").each(function(){b=$(this);b.uiVal(b.attr("data-default")||"")});var d=a.find("select:not([data-role='selectbutton'])");d.not("[data-default],[data-default-index]").selectedIndex(0);d.filter("select[data-default]").each(function(){b=
$(this);b.uiVal(b.attr("data-default"))});d.filter("select[data-default-index]").each(function(){this.selectedIndex=parseInt(this.getAttribute("data-default-index"),10);Common.refreshElement(this)});a.find("input:radio,input:checkbox").each(function(){this.checked="true"===this.getAttribute("data-default-checked");Common.refreshElement(this)});a.find("[data-default-disabled]").each(function(){b=$(this);b.enable("true"!==b.attr("data-default-disabled"))})};
Common.refreshFormElements=function(a){a=$(a);a.find("select[data-role!='slider']").selectmenu("refresh");a.find("select[data-role='slider']").slider("refresh");a.find("input:button[data-default-disabled]").button("refresh");a.find("input:radio,input:checkbox").checkboxradio("refresh")};$.fn.refresh=function(){for(var a=0;a<this.length;a++)Common.refreshElement(this[a]);return this};$.fn.uiVal=function(){var a=$.fn.val.apply(this,arguments);arguments.length&&a.refresh();return a};
$.fn.nullVal=function(){var a=$.fn.val.apply(this,arguments);!arguments.length&&""===a&&(a=null);return a};$.fn.dataObj=function(a){if(this[0])return!arguments.length?this.data.call(this,"dataObj"):this.data.call(this,"dataObj",a)};$.fn.dataObjArray=function(){for(var a=[],b=0;b<this.length;b++)a.push($.data(this[b],"dataObj"));return a};$.fn.removeDataObj=function(){return this.removeData.call(this,"dataObj")};
Common.propRefresh=function(a,b){if(this[0])return void 0===b?this.prop(a):this.prop(a,b).refresh()};Common.refreshElement=function(a){a=$.data(a);a.mobileCheckboxradio?a.mobileCheckboxradio.refresh.call(a.mobileCheckboxradio):a.mobileSelectmenu?a.mobileSelectmenu.refresh.call(a.mobileSelectmenu):a.mobileSlider?a.mobileSlider.refresh.call(a.mobileSlider):a.mobileListview?a.mobileListview.refresh.call(a.mobileListview):a.mobileButton&&a.mobileButton.refresh.call(a.mobileButton)};
$.fn.radioVal=function(a){var b=this[0];if(b){if(!arguments.length){for(var b=document.getElementsByName(b.id),d=0;d<b.length;d++)if(b[d].checked)return b[d].value;return""}return this.each(function(){for(var b=document.getElementsByName(this.id),d=0;d<b.length;d++)b[d].checked=b[d].value===a,Common.refreshElement(b[d])})}};
$.fn.checked=function(a){if(this[0]){if(!arguments.length)return this.prop("checked");this.prop("checked",a);if(!a)return this.refresh();for(var b=0;b<this.length;b++){var d=this[b],c;if("INPUT"===d.tagName&&"radio"===d.getAttribute("type")&&null!==(c=d.getAttribute("name")))for(var d=document.getElementsByName(c),e=0;e<d.length;e++)Common.refreshElement(d[e]);else Common.refreshElement(d)}return this}};$.fn.selectedIndex=function(a){return Common.propRefresh.call(this,"selectedIndex",a)};
$.fn.switchState=function(a){void 0!==a&&(a=a?1:0);var b=Common.propRefresh.call(this,"selectedIndex",a);return void 0===a?1==b?!0:!1:b};$.fn.btnText=function(a){return this.each(function(){var b=$(this);b.hasClass("ui-btn")&&(b=b.find(".ui-btn-text"));b.text(a)})};
$.fn.enable=function(a){return!1===a?$.fn.disable.apply(this,arguments):this.each(function(){var a=$.data(this);a.mobileCheckboxradio?a.mobileCheckboxradio.enable.call(a.mobileCheckboxradio):a.mobileSelectmenu?a.mobileSelectmenu.enable.call(a.mobileSelectmenu):a.mobileSlider?a.mobileSlider.enable.call(a.mobileSlider):a.mobileButton?a.mobileButton.enable.call(a.mobileButton):a.mobileTextinput?a.mobileTextinput.enable.call(a.mobileTextinput):this.removeAttribute("disabled")})};
$.fn.disable=function(){return this.each(function(){var a=$.data(this);a.mobileCheckboxradio?a.mobileCheckboxradio.disable.call(a.mobileCheckboxradio):a.mobileSelectmenu?a.mobileSelectmenu.disable.call(a.mobileSelectmenu):a.mobileSlider?a.mobileSlider.disable.call(a.mobileSlider):a.mobileButton?a.mobileButton.disable.call(a.mobileButton):a.mobileTextinput?a.mobileTextinput.disable.call(a.mobileTextinput):this.setAttribute("disabled","disabled")})};
$.fn.numVal=function(a){var b=this[0];if(b){if(arguments.length)return this.each(function(){"number"==this.getAttribute("data-type")&&Common.setInputNumberValue(this,a)});if("number"==b.getAttribute("data-type"))return Common.getInputNumberValue(b)}};Common.handlers.dataTypeNumber_Change=function(){Common.setInputNumberValue(this,Common.getInputNumberValue(this))};
Common.setInputNumberValue=function(a,b){var d=a.getAttribute("data-number-mask"),c,e;if(d){e=-1!=d.indexOf(",");var d=d.replace(/,/,""),f=d.indexOf(".");c=-1==f?d.length:f;d=-1==f?0:d.length-f-1}else d=c=-1,e=!0;"string"==typeof b&&(b=Util.toFloat(b));if("number"==typeof b&&(0<=d&&(b=Util.round(b,d)),0>=c||b<Math.pow(10,c))){b=e?Util.numberToStringThousSep(b):Util.numberToString(b);if(0<d&&(c=b.indexOf(Translations.currentCulture.decimalSeparator),-1!=c))for(c=b.length-c-1;c<d;)b+="0",c++;a.value=
b;return}a.value=""};
Common.getInputNumberValue=function(a){var b=a.getAttribute("data-number-mask"),d;if(b){var b=b.replace(/,/,""),c=b.indexOf(".");d=-1==c?b.length:c;b=-1==c?0:b.length-c-1}else b=d=-1;var c=Translations.currentCulture.decimalSeparator,e=Translations.currentCulture.thousandSeparator,a=a.value.trim().replace(/ /g,"");if(/^[0-9\.,]+$/.test(a)){var f=a.indexOf(c),g=a.indexOf(e),h=a.lastIndexOf(e);-1==f&&-1!=g&&g==h&&2>=a.length-g-1?(0===g&&(a="0"+a),a.replace(e,c)):(" "!=e&&(a=a.replace("."==e?/\./g:/,/g,
"")),f=a.indexOf(c),-1!=f&&(e=a.lastIndexOf(c),f!=e&&(a=a.substring(0,a.indexOf(c,f+1)))),f==a.length-1&&(a=a.substring(0,f)));c=Util.toFloat(a);0<=b&&(c=Util.round(c,b));if(0>=d||c<Math.pow(10,d))return c}return null};Common.handlers.dataTypeDate_Blur=function(){"date"==this.getAttribute("type")?Util.isValidISODate(this.value)||(this.value=""):Util.isValidDate(this.value)||(this.value="")};
$.fn.dateVal=function(a){var b=this[0];if(b){if(arguments.length)return Util.isValidISODate(a)||(a=""),this.each(function(){if("date"==this.getAttribute("data-type"))if("date"==this.getAttribute("type")||""===a)this.value=a;else{var b=a.split("-");this.value=b[2]+"/"+b[1]+"/"+b[0]}});if("date"==b.getAttribute("data-type")){if("date"==b.getAttribute("type")){if(Util.isValidISODate(b.value))return b.value}else if(Util.isValidDate(b.value))return b=b.value.split("/"),1==b[0].length&&(b[0]="0"+b[0]),
1==b[1].length&&(b[1]="0"+b[1]),b[2]+"-"+b[1]+"-"+b[0];return null}}};Common.clearList=function(a){Common.clearChilds(a);"true"==a.getAttribute("data-filter")&&Common.clearListSearch(a)};Common.clearListSearch=function(a){a.parentNode&&(a=a.parentNode,$(a).find('[data-type="search"]').uiVal(""),$(a).find(".ui-input-clear").addClass("ui-input-clear-hidden"))};
Common.addListItem=function(a,b){if(b){var d=document.createElement("li");if(b.html)"string"==typeof b.html?$(d).html(b.html):$(d).append(b.html);else{var c;b.href||b.onclick?(c=document.createElement("a"),b.href?c.setAttribute("href",b.href):c.setAttribute("href","#"),b.onclick&&c.addEventListener("click",b.onclick,!1),d.appendChild(c)):c=d;if(void 0!=b.text){var e=document.createElement("span");e.appendChild(document.createTextNode(b.text));c.appendChild(e)}void 0!==b.textHtml&&(c.innerHTML=b.textHtml);
void 0!==b.subText&&(e=document.createElement("p"),e.setAttribute("class","ui-li-desc"),e.setAttribute("style","white-space: normal; margin: 2px 0 0;"),e.appendChild(document.createTextNode(b.subText)),c.appendChild(e));void 0!==b.countBubbleText&&(e=document.createElement("span"),e.setAttribute("class","ui-li-count"),e.appendChild(document.createTextNode(b.countBubbleText)),c.appendChild(e));if(b.splitText||b.splitHref||b.splitOnclick)c=void 0,c=document.createElement("a"),b.splitHref?c.setAttribute("href",
b.splitHref):c.setAttribute("href","#"),b.splitOnclick&&c.addEventListener("click",b.splitOnclick,!1),b.splitText&&c.appendChild(document.createTextNode(b.splitText)),d.appendChild(c)}b.data&&$.data(d,"dataObj",b.cloneData?$.extend(!0,{},b.data):b.data);b.update&&b.update($(d));a.appendChild(d)}};
Common.addCheckListItem=function(a,b,d,c,e,f){var g=document.createElement("span");g.setAttribute("class","li_checkbox");var h=document.createElement("span");h.setAttribute("class","li_content");var k=document.createElement("p");k.setAttribute("class","ui-li-desc");k.setAttribute("style","white-space: normal; margin: 0;");var l=document.createElement("span");l.setAttribute("class","ui-li-count");var j=document.createElement("li"),i=document.createElement("a");i.setAttribute("href","#");i.setAttribute("class",
"li_check");i.addEventListener("click",c,!1);i.appendChild(g);i.appendChild(h);i.appendChild(k);i.appendChild(l);j.appendChild(i);c=document.createElement("a");c.setAttribute("href","#");c.setAttribute("class","li_check_right");c.addEventListener("click",e,!1);j.appendChild(c);e=$(j);e.data("dataObj",d?$.extend(!0,{},b):b);f(e);a.appendChild(j)};
Common.addListDivider=function(a,b){var d=document.createElement("li");d.setAttribute("data-role","list-divider");d.appendChild(document.createTextNode(b));a.appendChild(d)};Common.createPhotoSwipe=function(a){for(;Code.PhotoSwipe.instances.length;)Code.PhotoSwipe.unsetActivateInstance(Code.PhotoSwipe.instances[0]),Code.PhotoSwipe.detatch(Code.PhotoSwipe.instances[0]);a.photoSwipe({backButtonHideEnabled:!1})};
Common.createDelete=function(a,b,d,c,e){return{Guid:a,IDGruppo:e,OtherIdentifier:c,Schema:d,TableName:b}};Common.focusToField=function(a){window.setTimeout(function(){var b=$("#"+a)[0];b&&(b.focus(),b.select())},200)};Common.clearChilds=function(a){if(a.hasChildNodes())for(;0<a.childNodes.length;)a.removeChild(a.firstChild)};Common.textareaAutoSize=function(a){var b=a[0].scrollHeight;a[0].clientHeight<b&&a.height(b+15)};
Common.formatListPrice=function(a,b,d){var c=Util.numberToStringThousSep(a);1!=b&&(c=b+" x "+c+" = "+Util.numberToStringThousSep(Util.round(a*b,2)));d&&(c+=" "+d);return c};Common.formatPack=function(a){for(var b="",d=0;d<a.pack.length;d++)""!==b&&(b+=", "),1!=a.pack[d].num&&(b+=a.pack[d].num+" x "),b+=a.pack[d].name;return b};Common.openLink=function(a){App.cordova?window.open(a,"_system"):window.open(a)};
Common.haveSameProperties=function(a,b){for(var d in a)if(!(d in b))return!1;for(var c in b)if(!(c in a))return!1;return!0};Common.getCurrencySymbol=function(a){switch(a){case "EUR":return"\u20ac";case "GBP":return"\u00a3";case "JPY":return"\u00a5";case "USD":return"$";default:return"?"}};
Common.getNavCat=function(a){switch(a){case "1":return"Unlimited";case "2":return"Within 12 miles";case "3":return"Within 3 miles";case "4":return"Rivers, canals and small lakes";case "5":return"Within  6 miles";case "6":return"Within 50 miles";case "7":return"A - Without limiting the coast";case "8":return"B - Offshore";case "9":return"C - Resort";case "10":return"D - Special";default:return""}};


var App={name:null,version:null,appleAppStoreID:null,appleWebAppIcon:null,showRegistration:null,wcfServiceUrl:null,registrationServiceUrl:null,platform:{webKit:null,iOS:!1,android:!1,version:{major:0,minor:0,revision:0,value:null}},host:null,storageHost:null,cordova:null,develop:!1,init:function(){App.cordova="undefined"!==typeof cordova;App.develop="undefined"!==typeof DEVELOP;App.host=App.cordova?"app3.digibusiness.it":window.location.host;var b=navigator.userAgent,a=/AppleWebKit\/([0-9\.]+)/.exec(b);
a&&1<a.length&&(App.platform.webKit=parseFloat(a[1]));if(/iPhone|iPad|iPod/.test(navigator.platform)){if(App.platform.iOS=!0,(a=/OS ([^1-4]_[0-9_]*) like Mac OS X/i.exec(b))&&1<a.length)if(a=a[1].split("_"),App.platform.version.major=parseInt(a[0],10),1<a.length&&(App.platform.version.minor=parseInt(a[1],10)),2<a.length)App.platform.version.revision=parseInt(a[2],10)}else if(-1!=b.indexOf("Android")&&(App.platform.android=!0,(a=/Android (\d+(?:\.\d+)*)/.exec(b))&&1<a.length))if(a=a[1].split("."),
App.platform.version.major=parseInt(a[0],10),1<a.length&&(App.platform.version.minor=parseInt(a[1],10)),2<a.length)App.platform.version.revision=parseInt(a[2],10);App.platform.version.value=App.platform.version.major+"."+App.platform.version.minor+"."+App.platform.version.revision;!App.cordova&&App.platform.iOS&&$.ajax({url:"appconfig.xml",dataType:"xml",type:"GET",async:!1,success:App.configInit,error:App.error,cache:!1})},configInit:function(b){b=$(b).children();App.name=b.children("appName").text();
App.version=b.children("appVersion").text();App.appleAppStoreID=b.children("appleAppStoreID").text();App.appleWebAppIcon=b.children("appleWebAppIcon").text();App.showRegistration="true"==b.children("showRegistration").text();App.storageHost=b.children("storageHost").text();App.wcfServiceUrl=b.children("wcfServiceUrl").text();App.registrationServiceUrl=b.children("registrationServiceUrl").text();App.cordova||(b=$("title").text(App.name),!App.develop&&App.platform.iOS&&($(document.createElement("meta")).attr("name",
"apple-mobile-web-app-title").attr("content",App.name).insertBefore(b),App.appleAppStoreID&&$(document.createElement("meta")).attr("name","apple-itunes-app").attr("content","app-id="+App.appleAppStoreID).insertBefore(b),App.appleWebAppIcon&&$(document.createElement("link")).attr("rel","apple-touch-icon-precomposed").attr("href",App.appleWebAppIcon).insertBefore(b)))},mobileInit:function(){$.mobile.autoInitializePage=!1;$.mobile.isPageInitialized=!1;$.mobile.changePage.defaults.changeHash=!1;$.mobile.hashListeningEnabled=
!1;$.mobile.zoom.locked=!0;$.mobile.zoom.enabled=!1;$.mobile.page.prototype.options.theme="c";$.mobile.page.prototype.options.headerTheme="c";$.mobile.page.prototype.options.footerTheme="c";$.mobile.listview.prototype.options.filterPlaceholder="";$.mobile.buttonMarkup.hoverDelay=50;$.support.cors=!0;$.ajaxSetup({timeout:15E3,headers:{"Cache-Control":"no-cache"}});$.mobile.allowCrossDomainPages=!0},ready:function(){if(!App.cordova&&"undefined"===typeof FormData)alert("Your browser is not compatible."),
$("body").empty();else{var b="code/main.html code/quotations.html code/boats.html code/contacts.html code/emails.html code/registration.html code/common.html".split(" ");(App.cordova||!App.platform.iOS)&&b.splice(0,0,"appconfig.xml");$.mobile||b.push("css/jquery.mobile-1.3.2.min.css","css/stylesheet.css","css/photoswipe.css","css/viewboat.css","js/jquery.mobile-1.3.2.min.js","js/jquery-ui-1.10.3.min.js","js/jquery.ui.touch-punch.min.js","js/jquery.validate.min.js","js/util.js","js/x2j.js","js/n2WcfClient.js",
"js/credentialsManager.js","js/iScroll.js","code/translations.js","code/main.html.js","code/quotations.html.js","code/boats.html.js","code/contacts.html.js","code/emails.html.js","code/registration.html.js","code/common.html.js","js/viewboat.js","js/klass.min.js","js/code.photoswipe.jquery-3.0.5.min.js");App.getComponents(b,function(a){if(CredentialsManager.init()){(App.cordova||!App.platform.iOS)&&App.configInit(a.shift());N2WcfClient.wcfServiceUrl=App.wcfServiceUrl;Registration.serviceUrl=App.registrationServiceUrl;
for(var b=0;b<a.length;b++)$("body").append(a[b]);$(".appname").text(App.name);App.showRegistration||$("#main_login_registration").css("display","none");a=$("[data-role='page']:not([data-fixed-toolbar='false'])");App.platform.iOS&&5>App.platform.version.major?(a.find(".header").addClass("header_iscroll"),a.find(".footer").addClass("footer_iscroll"),a.find(".contentfooter").addClass("contentfooter_iscroll"),a.find(".content").addClass("content_iscroll"),a.on("pageshow",function(){Common.activateiScroll(this)})):
(a.find(".header,.footer").attr("data-position","fixed").attr("data-tap-toggle","false"),a.find(".header").addClass("header_fixed"),a.find(".footer").addClass("footer_fixed"),a.find(".contentfooter").addClass("contentfooter_fixed"),a.find(".content").addClass("content_fixed"));(600>$(window).height()||600>$(window).width())&&$(".menu-left .header").removeAttr("data-position").removeAttr("data-tap-toggle");$("form:not([action])").attr("data-ajax","false").on("submit",function(a){a.preventDefault();
a.stopPropagation();return false});$.validator.setDefaults({onsubmit:!1,errorPlacement:function(a,b){b.closest(".ui-field-contain").append(a)}});$(document).on("culturechanged",function(){var a=Transl("MainInvalidField","Invalid field");$.extend($.validator.messages,{required:Transl("MainMandatoryField","Mandatory field"),email:a,url:a,date:a,dateISO:a,number:a,digits:a,creditcard:a,equalTo:$.validator.format(Transl("MainInvalidEqualToField","Please enter the same value again")),maxlength:$.validator.format(Transl("MainInvalidMaxLengthField",
"Please enter no more than {0} characters")),minlength:$.validator.format(Transl("MainInvalidMinLengthField","Please enter at least {0} characters")),rangelength:$.validator.format(Transl("MainInvalidRangeLengthField","Please enter a value between {0} and {1} characters long"))})});Translations.init(CredentialsManager.getCulture(),function(){$(document).trigger("appready");if(CM.areCredentialsStored()){$(document).one("pageshow",function(){Main.refreshUserEnableTimer(false)});Main.showHome()}else Common.changePage("login");
window.setInterval(Main.checkUserPermissions,72E5)},Common.wcfError)}else Common.alert("Cookie functionality is disabled.\nEnable cookie functionality and try again."),$("body").empty()},App.error)}},backbutton:function(){CM.areCredentialsStored()?Main.logout():navigator.app.exitApp()},getComponents:function(b,a,f,c){var e=b.shift(),d=void 0;switch(e.substr(e.lastIndexOf(".")+1)){case "css":d="css";break;case "html":d="html";break;case "js":d="script";break;case "xml":case "xaml":d="xml"}if("css"==
d){var g=$("<link>");g.attr({type:"text/css",rel:"stylesheet",href:e+"?_="+$.now()});$("head").append(g);0==b.length?a(c):App.getComponents(b,a,f,c)}else $.ajax({url:e,dataType:d,success:function(e){c||(c=[]);"script"!=d&&c.push(e);0==b.length?a(c):App.getComponents(b,a,f,c)},error:f,cache:!1})},error:function(){alert("Communication error. Check your internet connection and try again.")}};App.init();$(document).on("mobileinit",App.mobileInit);
$(function(){App.cordova?(document.addEventListener("deviceready",App.ready,!1),App.platform.android&&document.addEventListener("backbutton",App.backbutton,!1)):App.ready()});



var Registration={serviceUrl:null,email:null,password:null,captchaID:null,handlers:{}};
$(document).on("appready",function(){$("#registration-step-1").validate({rules:{Email:{required:!0,email:!0},Pwd1:{required:!0,rangelength:[8,50]},Pwd2:{required:!0,equalTo:"#registration_password"}}});$("#registration-step-2").validate({rules:{Name:"required",Captcha:"required",Privacy:"required"}});$("#registration").on("pageshow",function(){Common.focusToField("registration_email")});Registration.show=function(){Registration.captchaID||(Registration.captchaID=Util.createNewGuid());var a=$("#registration_country"),
b=Translations.currentCultureName,c=function(){Registration._resetForm($("#registration-step-1"));Registration._resetForm($("#registration-step-2"));$("#registration_mandatory_field").removeClass("disabled-label");$("#registration_password").unbind(".validate-equalTo");a.uiVal(b.substr(3,2));$("#registration-step-2, #registration-complete").css("display","none");Common.changePage("registration","slide")};0==a.children().length||a.attr("data-countries-culture")!==b?Registration._postToRegistrationService("GetCountries",
null,function(d){$.each(d,function(){a.append($("<option/>").attr("value",this.ISOCode).text(this.Description))});a.attr("data-countries-culture",b);c()}):c()};Registration.handlers.cancel_Click=function(){Common.changePage("login","slide",!0)};Registration.handlers.btnNext_Click=function(){var a=$("#registration-step-1");if(Registration._validateForm(a)){var b=a.serialize();Registration.email=$("#registration_email").val();Registration.password=$("#registration_password").val();Registration._postToRegistrationService("CheckBaseData",
b,function(b){b.success?(Registration._disableForm(a),Registration._refreshCaptcha(),Registration._fadeInAndScrollToElement($("#registration-step-2"),function(){$("#registration_name").focus()})):"UsernameAlreadyExists"==b.result?Common.alert(Transl("RegistrationModuleEmailAlreadyRegistered","The email you entered is already associated with a Navis.net user.")):Common.alert(Transl("RegistrationModuleGenericError","An unexpected error occurred during user registration."))})}};Registration.handlers.btnCompleteRegistration_Click=
function(){var a=$("#registration-step-2");if(Registration._validateForm(a)){var b=a.serializeArray();b.push({name:"Email",value:Registration.email});b.push({name:"Password",value:Registration.password});b.push({name:"CaptchaID",value:Registration.captchaID});Registration._postToRegistrationService("CreateNewUser",b,function(b){b.success?(Registration._disableForm(a),$("#registration_mandatory_field").addClass("disabled-label"),b=$("#registration-complete"),b.find("h3").text(Transl("RegistrationModuleEmailSent",
"We sent an email to the address {0}.").format(Registration.email)),Registration._fadeInAndScrollToElement(b)):("IvalidCaptcha"==b.result?Registration._showValidationErrors($("#registration-step-2"),{Captcha:Transl("MainInvalidField","Invalid field")}):Common.alert(Transl("RegistrationModuleGenericError","An unexpected error occurred during user registration.")),Registration._refreshCaptcha())})}};Registration.handlers.btnLogin_Click=function(){Main.loginStoreCredentials(Registration.email,Registration.password,
!0,null,Main.showHome,Common.wcfError,null,Transl("RegistrationModuleINavisSignInError","Your username has not yet been activated. Make sure you've clicked the link that we sent to {0}.").format(Registration.email))};Registration._validateForm=function(a){if(a.valid())return!0;a.validate().focusInvalid();return!1};Registration._showValidationErrors=function(a,b){var c=a.validate();c.showErrors(b);c.focusInvalid()};Registration._refreshCaptcha=function(){var a=Translations.currentCultureName.substr(0,
2);$("#registration_captcha_img").attr("src",Registration.serviceUrl+a+"/GetCaptcha?captchaID="+encodeURIComponent(Registration.captchaID)+"&t="+$.now())};Registration._resetForm=function(a){Common.resetFormElements(a);a.find("input,select").enable();a.find("img").removeClass("disabled-images");a.find("label.error").remove();a.find("label").removeClass("disabled-label");a.validate().resetForm()};Registration._disableForm=function(a){a.find(".ui-focus").removeClass("ui-focus");a.find("input,select").disable();
a.find("img").addClass("disabled-images");a.find("label:not(.error)").addClass("disabled-label")};Registration._fadeInAndScrollToElement=function(a,b){a.fadeIn(400,b);$("html, body").animate({scrollTop:Math.max(a.offset().top-50,50)},400)};Registration._postToRegistrationService=function(a,b,c,d){Common.showLoading();$.ajax({url:Registration.serviceUrl+Translations.currentCultureName.substr(0,2)+"/"+a,type:"POST",xhrFields:{withCredentials:!0},data:b,dataType:"json",success:c,error:d||Common.wcfError,
complete:function(){Common.hideLoading()}})}});



function N2WcfClient(){}N2WcfClient.wcfServiceUrl=null;N2WcfClient.xmlns={webMethods:"http://tempuri.org/",soapAction:"http://tempuri.org/INavisServices/",soapEnvelope:"http://schemas.xmlsoap.org/soap/envelope/",xmlSchemaInstance:"http://www.w3.org/2001/XMLSchema-instance",digibusinessNavisItems:"http://schemas.datacontract.org/2004/07/Digibusiness.Navis.Items",serializationArrays:"http://schemas.microsoft.com/2003/10/Serialization/Arrays"};
N2WcfClient.msgPriority={Lowest:0,VeryLow:1,Low:2,Normal:3,AboveNormal:4,High:5,VeryHigh:6,Highest:7};N2WcfClient.invoke=function(a,f,c,g,d,h){f='<s:Envelope xmlns:s="'+N2WcfClient.xmlns.soapEnvelope+'"><s:Body><'+a+' xmlns="'+N2WcfClient.xmlns.webMethods+'" xmlns:i="'+N2WcfClient.xmlns.xmlSchemaInstance+'">'+N2WcfClient.serializeObj(f)+"</"+a+"></s:Body></s:Envelope>";return N2WcfClient._invoke(a,f,c,g,d,h)};
N2WcfClient.insertIntoQueueList=function(a,f,c,g,d,h,b,i){a.sort(function(a,b){return N2WcfClient.msgPriority[b.priority||"Normal"]-N2WcfClient.msgPriority[a.priority||"Normal"]});var e=0,j=function(){N2WcfClient.insertIntoQueue(a[e],function(){e++;e<a.length?j():f()},c,g,d,h,b,i)};j()};
N2WcfClient.insertIntoQueue=function(a,f,c,g,d,h,b,i){var e='<s:Envelope xmlns:s="'+N2WcfClient.xmlns.soapEnvelope+'"><s:Body><InsertIntoQueue xmlns="'+N2WcfClient.xmlns.webMethods+'"><Msg xmlns:i="'+N2WcfClient.xmlns.xmlSchemaInstance+'">';a.body?(e+='<Body i:type="'+a.bodyType+'" xmlns="">',e+=N2WcfClient.serializeObj(a.body,a.bodyPrefix)+"</Body>"):e+='<Body i:nil="true" xmlns="" />';e+='<FileName xmlns=""'+(a.fileName?">"+Util.htmlEscape(a.fileName)+"</FileName>":" />")+'<Guid xmlns="">'+(a.guid||
Util.createNewGuid())+'</Guid><Multipart xmlns="">false</Multipart><Part xmlns="">0</Part><Parts i:nil="true" xmlns="" xmlns:a="'+N2WcfClient.xmlns.serializationArrays+'" /><TimeStamp xmlns="">'+Util.dateToISODateTime(new Date,!0,!0)+'</TimeStamp><CopyFrom xmlns=""'+(a.copyFrom?">"+Util.htmlEscape(a.copyFrom)+"</CopyFrom>":' i:nil="true" />')+'<Description xmlns=""'+(a.descr?">"+Util.htmlEscape(a.descr)+"</Description>":' i:nil="true" />')+'<Directory xmlns="">'+d+'</Directory><IDGruppo xmlns="">'+
d+'</IDGruppo><IDUtente xmlns="">'+g+'</IDUtente><Password xmlns="">'+i+'</Password><Schema xmlns=""'+(a.schema?">"+Util.htmlEscape(a.schema)+"</Schema>":' i:nil="true" />')+'<Type xmlns=""'+(a.type?">"+Util.htmlEscape(a.type)+"</Type>":' i:nil="true" />')+'<UserGuid xmlns="">'+h+'</UserGuid><Utente xmlns="">'+b+"</Utente></Msg><Priority>"+(a.priority||"Normal")+"</Priority><IDUser>"+g+"</IDUser><User>"+b+"</User><Pwd>"+i+"</Pwd><IDGroup>"+d+"</IDGroup></InsertIntoQueue></s:Body></s:Envelope>";return N2WcfClient._invoke("InsertIntoQueue",
e,f,c)};
N2WcfClient.serializeObj=function(a,f){var c="";switch(Object.prototype.toString.call(a)){case "[object String]":c=Util.htmlEscape(a);break;case "[object Number]":c=a.toString();break;case "[object Boolean]":c=a?"true":"false";break;case "[object Date]":c=Util.dateToISODateTime(a,!0,!1);break;case "[object Object]":for(var g in a)if("$xmlns"!=g){var d=a[g],h=(f?f+":":"")+g;if(void 0===d||null===d)c+="<"+h+' i:nil="true" />';else{var b=Object.prototype.toString.call(d);if("[object Array]"==b)for(b=
0;b<d.length;b++)var c=c+("<"+h),i=N2WcfClient.serializeObj(d[b],f),c=void 0===i||null===i?c+' i:nil="true" />':c+(""===i?" />":">"+i+"</"+h+">");else{var i=void 0,e="";if("[object Object]"==b&&void 0!=d.$xmlns)for(var j=d.$xmlns.split(" "),b=j.length-1;0<=b;b--)if(j[b]){var k=j[b].indexOf(":");-1!=k&&(i=j[b].substr(0,k),e=" xmlns:"+i+'="'+N2WcfClient.xmlns[j[b].substr(k+1)]+'"'+e)}i=N2WcfClient.serializeObj(d,i||f);c+="<"+h+e+(""===i?" />":">"+i+"</"+h+">")}}}}return c};
N2WcfClient._invoke=function(a,f,c,g,d,h){f={url:N2WcfClient.wcfServiceUrl,global:!1,type:"POST",contentType:"text/xml",headers:{SOAPAction:N2WcfClient.xmlns.soapAction+a,"Cache-Control":"no-cache"},data:f,dataType:"xml",success:function(b,f,e){if(200==e.status&&b&&b.documentElement&&"s:Envelope"==b.documentElement.nodeName){var d=!1;if((b=b.documentElement.firstChild)&&"s:Body"==b.nodeName)if((b=b.firstChild)&&b.nodeName==a+"Response")if("InsertIntoQueue"===a){try{c&&c()}catch(h){g&&g(e,"error",
h.name+": "+h.message)}d=!0}else if((b=b.firstChild)&&b.nodeName==a+"Result"){try{c&&c($.xmlToJSON(b))}catch(l){g&&g(e,"error",l.name+": "+l.message)}d=!0}}!d&&g&&g(e,"parsererror","Ivalid Navis 2 WCF Service object")},error:g,complete:d};h&&(f=$.extend(h,f));return $.ajax(f)};


(function(){var g=Math,f=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",t="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,l="ontouchstart"in window,y=f+"Transform"in document.documentElement.style,z=/android/gi.test(navigator.appVersion),u=/iphone|ipad/gi.test(navigator.appVersion),p=/playbook/gi.test(navigator.appVersion),B=u||p,C=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){return setTimeout(b,1)},A=window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,v="onorientationchange"in window?"orientationchange":"resize",w=l?"touchstart":"mousedown",q=l?"touchmove":"mousemove",r=l?"touchend":"mouseup",s=l?"touchcancel":"mouseup",x="Moz"==f?"DOMMouseScroll":
"mousewheel",n="translate"+(t?"3d(":"("),o=t?",0)":")",p=function(b,a){var c=this,d=document,e;c.wrapper="object"==typeof b?b:d.getElementById(b);c.wrapper.style.overflow="hidden";c.scroller=c.wrapper.children[0];c.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:z,hideScrollbar:u,fadeScrollbar:u&&t,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,
wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(e in a)c.options[e]=a[e];c.x=c.options.x;c.y=c.options.y;c.options.useTransform=y?c.options.useTransform:!1;c.options.hScrollbar=c.options.hScroll&&c.options.hScrollbar;c.options.vScrollbar=c.options.vScroll&&
c.options.vScrollbar;c.options.zoom=c.options.useTransform&&c.options.zoom;c.options.useTransition=B&&c.options.useTransition;c.scroller.style[f+"TransitionProperty"]=c.options.useTransform?"-"+f.toLowerCase()+"-transform":"top left";c.scroller.style[f+"TransitionDuration"]="0";c.scroller.style[f+"TransformOrigin"]="0 0";c.options.useTransition&&(c.scroller.style[f+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");c.options.useTransform?c.scroller.style[f+"Transform"]=n+c.x+"px,"+c.y+
"px"+o:c.scroller.style.cssText+=";position:absolute;top:"+c.y+"px;left:"+c.x+"px";c.options.useTransition&&(c.options.fixedScrollbar=!0);c.refresh();c._bind(v,window);c._bind(w);l||(c._bind("mouseout",c.wrapper),c._bind(x));c.options.checkDOMChanges&&(c.checkDOMTime=setInterval(function(){c._checkDOMChanges()},500))};p.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(b){switch(b.type){case w:if(!l&&0!==b.button)break;
this._start(b);break;case q:this._move(b);break;case r:case s:this._end(b);break;case v:this._resize();break;case x:this._wheel(b);break;case "mouseout":this._mouseout(b);break;case "webkitTransitionEnd":this._transitionEnd(b)}},_checkDOMChanges:function(){!this.moved&&(!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale))&&this.refresh()},_scrollbar:function(b){var a=document,c;this[b+"Scrollbar"]?(this[b+"ScrollbarWrapper"]||
(c=a.createElement("div"),this.options.scrollbarClass?c.className=this.options.scrollbarClass+b.toUpperCase():c.style.cssText="position:absolute;z-index:100;"+("h"==b?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px"),c.style.cssText+=";pointer-events:none;-"+f+"-transition-property:opacity;-"+f+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?
"0":"1"),this.wrapper.appendChild(c),this[b+"ScrollbarWrapper"]=c,c=a.createElement("div"),this.options.scrollbarClass||(c.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+f+"-background-clip:padding-box;-"+f+"-box-sizing:border-box;"+("h"==b?"height:100%":"width:100%")+";-"+f+"-border-radius:3px;border-radius:3px"),c.style.cssText+=";pointer-events:none;-"+f+"-transition-property:-"+f+"-transform;-"+f+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+
f+"-transition-duration:0;-"+f+"-transform:"+n+"0,0"+o,this.options.useTransition&&(c.style.cssText+=";-"+f+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),this[b+"ScrollbarWrapper"].appendChild(c),this[b+"ScrollbarIndicator"]=c),"h"==b?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=g.max(g.round(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW),8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=
this.hScrollbarSize-this.hScrollbarIndicatorSize,this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=g.max(g.round(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH),8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY),this._scrollbarPos(b,!0)):
this[b+"ScrollbarWrapper"]&&(y&&(this[b+"ScrollbarIndicator"].style[f+"Transform"]=""),this[b+"ScrollbarWrapper"].parentNode.removeChild(this[b+"ScrollbarWrapper"]),this[b+"ScrollbarWrapper"]=null,this[b+"ScrollbarIndicator"]=null)},_resize:function(){var b=this;setTimeout(function(){b.refresh()},z?200:0)},_pos:function(b,a){b=this.hScroll?b:0;a=this.vScroll?a:0;this.options.useTransform?this.scroller.style[f+"Transform"]=n+b+"px,"+a+"px"+o+" scale("+this.scale+")":(b=g.round(b),a=g.round(a),this.scroller.style.left=
b+"px",this.scroller.style.top=a+"px");this.x=b;this.y=a;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(b,a){var c="h"==b?this.x:this.y;this[b+"Scrollbar"]&&(c*=this[b+"ScrollbarProp"],0>c?(this.options.fixedScrollbar||(c=this[b+"ScrollbarIndicatorSize"]+g.round(3*c),8>c&&(c=8),this[b+"ScrollbarIndicator"].style["h"==b?"width":"height"]=c+"px"),c=0):c>this[b+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?c=this[b+"ScrollbarMaxScroll"]:(c=this[b+"ScrollbarIndicatorSize"]-
g.round(3*(c-this[b+"ScrollbarMaxScroll"])),8>c&&(c=8),this[b+"ScrollbarIndicator"].style["h"==b?"width":"height"]=c+"px",c=this[b+"ScrollbarMaxScroll"]+(this[b+"ScrollbarIndicatorSize"]-c))),this[b+"ScrollbarWrapper"].style[f+"TransitionDelay"]="0",this[b+"ScrollbarWrapper"].style.opacity=a&&this.options.hideScrollbar?"0":"1",this[b+"ScrollbarIndicator"].style[f+"Transform"]=n+("h"==b?c+"px,0":"0,"+c+"px")+o)},_start:function(b){var a=l?b.touches[0]:b,c,d;if(this.enabled){this.options.onBeforeScrollStart&&
this.options.onBeforeScrollStart.call(this,b);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;this.options.zoom&&(l&&1<b.touches.length)&&(d=g.abs(b.touches[0].pageX-b.touches[1].pageX),c=g.abs(b.touches[0].pageY-b.touches[1].pageY),this.touchesDistStart=g.sqrt(d*d+c*c),this.originX=g.abs(b.touches[0].pageX+b.touches[1].pageX-2*this.wrapperOffsetLeft)/2-this.x,
this.originY=g.abs(b.touches[0].pageY+b.touches[1].pageY-2*this.wrapperOffsetTop)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,b));if(this.options.momentum&&(this.options.useTransform?(c=getComputedStyle(this.scroller,null)[f+"Transform"].replace(/[^0-9-.,]/g,"").split(","),d=1*c[4],c=1*c[5]):(d=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,""),c=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),d!=this.x||c!=this.y))this.options.useTransition?
this._unbind("webkitTransitionEnd"):A(this.aniTime),this.steps=[],this._pos(d,c);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=a.pageX;this.pointY=a.pageY;this.startTime=b.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,b);this._bind(q);this._bind(r);this._bind(s)}},_move:function(b){var a=l?b.touches[0]:b,c=a.pageX-this.pointX,d=a.pageY-this.pointY,e=this.x+c,i=this.y+d,h=b.timeStamp||Date.now();this.options.onBeforeScrollMove&&
this.options.onBeforeScrollMove.call(this,b);if(this.options.zoom&&l&&1<b.touches.length)e=g.abs(b.touches[0].pageX-b.touches[1].pageX),i=g.abs(b.touches[0].pageY-b.touches[1].pageY),this.touchesDist=g.sqrt(e*e+i*i),this.zoomed=!0,a=1/this.touchesDistStart*this.touchesDist*this.scale,a<this.options.zoomMin?a=0.5*this.options.zoomMin*Math.pow(2,a/this.options.zoomMin):a>this.options.zoomMax&&(a=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/a)),this.lastScale=a/this.scale,e=this.originX-
this.originX*this.lastScale+this.x,i=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[f+"Transform"]=n+e+"px,"+i+"px"+o+" scale("+a+")",this.options.onZoom&&this.options.onZoom.call(this,b);else{this.pointX=a.pageX;this.pointY=a.pageY;if(0<e||e<this.maxScrollX)e=this.options.bounce?this.x+c/2:0<=e||0<=this.maxScrollX?0:this.maxScrollX;if(i>this.minScrollY||i<this.maxScrollY)i=this.options.bounce?this.y+d/2:i>=this.minScrollY||0<=this.maxScrollY?this.minScrollY:this.maxScrollY;6>
this.absDistX&&6>this.absDistY?(this.distX+=c,this.distY+=d,this.absDistX=g.abs(this.distX),this.absDistY=g.abs(this.distY)):(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(i=this.y,d=0):this.absDistY>this.absDistX+5&&(e=this.x,c=0)),this.moved=!0,this._pos(e,i),this.dirX=0<c?-1:0>c?1:0,this.dirY=0<d?-1:0>d?1:0,300<h-this.startTime&&(this.startTime=h,this.startX=this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,b))}},_end:function(b){if(!(l&&0!=
b.touches.length)){var a=this,c=l?b.changedTouches[0]:b,d,e,i={dist:0,time:0},h={dist:0,time:0},k=(b.timeStamp||Date.now())-a.startTime,j=a.x,m=a.y;a._unbind(q);a._unbind(r);a._unbind(s);a.options.onBeforeScrollEnd&&a.options.onBeforeScrollEnd.call(a,b);if(a.zoomed)j=a.scale*a.lastScale,j=Math.max(a.options.zoomMin,j),j=Math.min(a.options.zoomMax,j),a.lastScale=j/a.scale,a.scale=j,a.x=a.originX-a.originX*a.lastScale+a.x,a.y=a.originY-a.originY*a.lastScale+a.y,a.scroller.style[f+"TransitionDuration"]=
"200ms",a.scroller.style[f+"Transform"]=n+a.x+"px,"+a.y+"px"+o+" scale("+a.scale+")",a.zoomed=!1,a.refresh(),a.options.onZoomEnd&&a.options.onZoomEnd.call(a,b);else{if(a.moved){if(300>k&&a.options.momentum){i=j?a._momentum(j-a.startX,k,-a.x,a.scrollerW-a.wrapperW+a.x,a.options.bounce?a.wrapperW:0):i;h=m?a._momentum(m-a.startY,k,-a.y,0>a.maxScrollY?a.scrollerH-a.wrapperH+a.y-a.minScrollY:0,a.options.bounce?a.wrapperH:0):h;j=a.x+i.dist;m=a.y+h.dist;if(0<a.x&&0<j||a.x<a.maxScrollX&&j<a.maxScrollX)i=
{dist:0,time:0};if(a.y>a.minScrollY&&m>a.minScrollY||a.y<a.maxScrollY&&m<a.maxScrollY)h={dist:0,time:0}}i.dist||h.dist?(i=g.max(g.max(i.time,h.time),10),a.options.snap&&(h=j-a.absStartX,k=m-a.absStartY,g.abs(h)<a.options.snapThreshold&&g.abs(k)<a.options.snapThreshold?a.scrollTo(a.absStartX,a.absStartY,200):(h=a._snap(j,m),j=h.x,m=h.y,i=g.max(h.time,i))),a.scrollTo(g.round(j),g.round(m),i)):a.options.snap?(h=j-a.absStartX,k=m-a.absStartY,g.abs(h)<a.options.snapThreshold&&g.abs(k)<a.options.snapThreshold?
a.scrollTo(a.absStartX,a.absStartY,200):(h=a._snap(a.x,a.y),(h.x!=a.x||h.y!=a.y)&&a.scrollTo(h.x,h.y,h.time))):a._resetPos(200)}else l&&(a.doubleTapTimer&&a.options.zoom?(clearTimeout(a.doubleTapTimer),a.doubleTapTimer=null,a.options.onZoomStart&&a.options.onZoomStart.call(a,b),a.zoom(a.pointX,a.pointY,1==a.scale?a.options.doubleTapZoom:1),a.options.onZoomEnd&&setTimeout(function(){a.options.onZoomEnd.call(a,b)},200)):a.doubleTapTimer=setTimeout(function(){a.doubleTapTimer=null;for(d=c.target;1!=
d.nodeType;)d=d.parentNode;"SELECT"!=d.tagName&&("INPUT"!=d.tagName&&"TEXTAREA"!=d.tagName)&&(e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,b.view,1,c.screenX,c.screenY,c.clientX,c.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,null),e._fake=!0,d.dispatchEvent(e))},a.options.zoom?250:0)),a._resetPos(200);a.options.onTouchEnd&&a.options.onTouchEnd.call(a,b)}}},_resetPos:function(b){var a=0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,c=this.y>=this.minScrollY||
0<this.maxScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y;if(a==this.x&&c==this.y){if(this.moved&&(this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this)),this.hScrollbar&&this.options.hideScrollbar&&("webkit"==f&&(this.hScrollbarWrapper.style[f+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0"),this.vScrollbar&&this.options.hideScrollbar)"webkit"==f&&(this.vScrollbarWrapper.style[f+"TransitionDelay"]="300ms"),this.vScrollbarWrapper.style.opacity=
"0"}else this.scrollTo(a,c,b||0)},_wheel:function(b){var a=this,c,d;"wheelDeltaX"in b?(c=b.wheelDeltaX/12,d=b.wheelDeltaY/12):c="detail"in b?d=3*-b.detail:d=-b.wheelDelta;if("zoom"==a.options.wheelAction){if(d=a.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),d<a.options.zoomMin&&(d=a.options.zoomMin),d>a.options.zoomMax&&(d=a.options.zoomMax),d!=a.scale)!a.wheelZoomCount&&a.options.onZoomStart&&a.options.onZoomStart.call(a,b),a.wheelZoomCount++,a.zoom(b.pageX,b.pageY,d,400),setTimeout(function(){a.wheelZoomCount--;
!a.wheelZoomCount&&a.options.onZoomEnd&&a.options.onZoomEnd.call(a,b)},400)}else c=a.x+c,d=a.y+d,0<c?c=0:c<a.maxScrollX&&(c=a.maxScrollX),d>a.minScrollY?d=a.minScrollY:d<a.maxScrollY&&(d=a.maxScrollY),a.scrollTo(c,d,0)},_mouseout:function(b){var a=b.relatedTarget;if(a)for(;a=a.parentNode;)if(a==this.wrapper)return;this._end(b)},_transitionEnd:function(b){b.target==this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var b=this,a=b.x,c=b.y,d=Date.now(),e,f,h;
b.animating||(b.steps.length?(e=b.steps.shift(),e.x==a&&e.y==c&&(e.time=0),b.animating=!0,b.moved=!0,b.options.useTransition)?(b._transitionTime(e.time),b._pos(e.x,e.y),b.animating=!1,e.time?b._bind("webkitTransitionEnd"):b._resetPos(0)):(h=function(){var k=Date.now(),j;if(k>=d+e.time){b._pos(e.x,e.y);b.animating=false;b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b);b._startAni()}else{k=(k-d)/e.time-1;f=g.sqrt(1-k*k);k=(e.x-a)*f+a;j=(e.y-c)*f+c;b._pos(k,j);if(b.animating)b.aniTime=C(h)}},
h()):b._resetPos(400))},_transitionTime:function(b){b+="ms";this.scroller.style[f+"TransitionDuration"]=b;this.hScrollbar&&(this.hScrollbarIndicator.style[f+"TransitionDuration"]=b);this.vScrollbar&&(this.vScrollbarIndicator.style[f+"TransitionDuration"]=b)},_momentum:function(b,a,c,d,e){var a=g.abs(b)/a,f=a*a/0.0012;0<b&&f>c?(c+=e/(6/(6E-4*(f/a))),a=a*c/f,f=c):0>b&&f>d&&(d+=e/(6/(6E-4*(f/a))),a=a*d/f,f=d);return{dist:f*(0>b?-1:1),time:g.round(a/6E-4)}},_offset:function(b){for(var a=-b.offsetLeft,
c=-b.offsetTop;b=b.offsetParent;)a-=b.offsetLeft,c-=b.offsetTop;b!=this.wrapper&&(a*=this.scale,c*=this.scale);return{left:a,top:c}},_snap:function(b,a){var c,d,e;e=this.pagesX.length-1;c=0;for(d=this.pagesX.length;c<d;c++)if(b>=this.pagesX[c]){e=c;break}e==this.currPageX&&(0<e&&0>this.dirX)&&e--;b=this.pagesX[e];d=(d=g.abs(b-this.pagesX[this.currPageX]))?500*(g.abs(this.x-b)/d):0;this.currPageX=e;e=this.pagesY.length-1;for(c=0;c<e;c++)if(a>=this.pagesY[c]){e=c;break}e==this.currPageY&&(0<e&&0>this.dirY)&&
e--;a=this.pagesY[e];c=(c=g.abs(a-this.pagesY[this.currPageY]))?500*(g.abs(this.y-a)/c):0;this.currPageY=e;e=g.round(g.max(d,c))||200;return{x:b,y:a,time:e}},_bind:function(b,a,c){(a||this.scroller).addEventListener(b,this,!!c)},_unbind:function(b,a,c){(a||this.scroller).removeEventListener(b,this,!!c)},destroy:function(){this.scroller.style[f+"Transform"]="";this.vScrollbar=this.hScrollbar=!1;this._scrollbar("h");this._scrollbar("v");this._unbind(v,window);this._unbind(w);this._unbind(q);this._unbind(r);
this._unbind(s);this.options.hasTouch&&(this._unbind("mouseout",this.wrapper),this._unbind(x));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var b,a,c,d=0;a=0;this.scale<this.options.zoomMin&&(this.scale=this.options.zoomMin);this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=-this.options.topOffset||
0;this.scrollerW=g.round(this.scroller.offsetWidth*this.scale);this.scrollerH=g.round((this.scroller.offsetHeight+this.minScrollY)*this.scale);this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);this.hScrollbar=
this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;b=this._offset(this.wrapper);this.wrapperOffsetLeft=-b.left;this.wrapperOffsetTop=-b.top;if("string"==typeof this.options.snap){this.pagesX=[];this.pagesY=[];c=this.scroller.querySelectorAll(this.options.snap);b=0;for(a=c.length;b<a;b++)d=this._offset(c[b]),d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,this.pagesX[b]=d.left<this.maxScrollX?this.maxScrollX:d.left*
this.scale,this.pagesY[b]=d.top<this.maxScrollY?this.maxScrollY:d.top*this.scale}else if(this.options.snap){for(this.pagesX=[];d>=this.maxScrollX;)this.pagesX[a]=d,d-=this.wrapperW,a++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);a=d=0;for(this.pagesY=[];d>=this.maxScrollY;)this.pagesY[a]=d,d-=this.wrapperH,a++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-this.pagesY[this.pagesY.length-
1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[f+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(b,a,c,d){var e=b;this.stop();e.length||(e=[{x:b,y:a,time:c,relative:d}]);b=0;for(a=e.length;b<a;b++)e[b].relative&&(e[b].x=this.x-e[b].x,e[b].y=this.y-e[b].y),this.steps.push({x:e[b].x,y:e[b].y,time:e[b].time||0});this._startAni()},scrollToElement:function(b,a){var c;if(b=b.nodeType?b:this.scroller.querySelector(b))c=
this._offset(b),c.left+=this.wrapperOffsetLeft,c.top+=this.wrapperOffsetTop,c.left=0<c.left?0:c.left<this.maxScrollX?this.maxScrollX:c.left,c.top=c.top>this.minScrollY?this.minScrollY:c.top<this.maxScrollY?this.maxScrollY:c.top,a=void 0===a?g.max(2*g.abs(c.left),2*g.abs(c.top)):a,this.scrollTo(c.left,c.top,a)},scrollToPage:function(b,a,c){this.options.onScrollStart&&this.options.onScrollStart.call(this);if(this.options.snap)b="next"==b?this.currPageX+1:"prev"==b?this.currPageX-1:b,a="next"==a?this.currPageY+
1:"prev"==a?this.currPageY-1:a,b=0>b?0:b>this.pagesX.length-1?this.pagesX.length-1:b,a=0>a?0:a>this.pagesY.length-1?this.pagesY.length-1:a,this.currPageX=b,this.currPageY=a,b=this.pagesX[b],a=this.pagesY[a];else if(b*=-this.wrapperW,a*=-this.wrapperH,b<this.maxScrollX&&(b=this.maxScrollX),a<this.maxScrollY)a=this.maxScrollY;this.scrollTo(b,a,c||400)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(q);this._unbind(r);this._unbind(s)},enable:function(){this.enabled=!0},
stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):A(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(b,a,c,d){var e=c/this.scale;this.options.useTransform&&(this.zoomed=!0,d=void 0===d?200:d,b=b-this.wrapperOffsetLeft-this.x,a=a-this.wrapperOffsetTop-this.y,this.x=b-b*e+this.x,this.y=a-a*e+this.y,this.scale=c,this.refresh(),this.x=0<this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?
this.maxScrollY:this.y,this.scroller.style[f+"TransitionDuration"]=d+"ms",this.scroller.style[f+"Transform"]=n+this.x+"px,"+this.y+"px"+o+" scale("+c+")",this.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};"undefined"!==typeof exports?exports.iScroll=p:window.iScroll=p})();


function CredentialsManager(){}var CM=CredentialsManager;
CredentialsManager.init=function(){if(CredentialsManager.checkStorageSupport()){if(localStorage.localStorageExpiration&&(new Date).getTime()>parseInt(localStorage.localStorageExpiration,10))CredentialsManager.clearLocalStorage();else if(!CredentialsManager.areCredentialsStored()&&null!=localStorage.username&&null!=localStorage.password&&null!=localStorage.name&&null!=localStorage.idUser&&null!=localStorage.idGroup&&null!=localStorage.guidUser&&null!=localStorage.email&&null!=localStorage.emailAlias&&
null!=localStorage.uniqueID&&null!=localStorage.culture&&null!=localStorage.isFreeUser){sessionStorage.username=localStorage.username;sessionStorage.password=localStorage.password;sessionStorage.name=localStorage.name;sessionStorage.idUser=localStorage.idUser;sessionStorage.idGroup=localStorage.idGroup;sessionStorage.guidUser=localStorage.guidUser;sessionStorage.email=localStorage.email;sessionStorage.emailAlias=localStorage.emailAlias;sessionStorage.uniqueID=localStorage.uniqueID;sessionStorage.culture=
localStorage.culture;sessionStorage.isFreeUser=localStorage.isFreeUser;sessionStorage.refreshUserLastCall=localStorage.refreshUserLastCall;sessionStorage.getUserLoggedLastCall=localStorage.getUserLoggedLastCall;var a=(new Date).getTime()+Math.random().toString().substr(2);sessionStorage.link=a;localStorage.link=a}return!0}return!1};CredentialsManager.checkStorageSupport=function(){return sessionStorage&&localStorage?!0:!1};
CredentialsManager.areCredentialsStored=function(){return null!==CredentialsManager.get("username")&&null!==CredentialsManager.get("password")&&null!==CredentialsManager.get("name")&&null!==CredentialsManager.get("idUser")&&null!==CredentialsManager.get("idGroup")&&null!==CredentialsManager.get("guidUser")&&null!==CredentialsManager.get("email")&&null!==CredentialsManager.get("emailAlias")&&null!==CredentialsManager.get("uniqueID")&&null!==CredentialsManager.get("culture")&&null!==CredentialsManager.get("isFreeUser")};
CredentialsManager.getUsername=function(){return CredentialsManager.get("username")};CredentialsManager.getPassword=function(){return CredentialsManager.get("password")};CredentialsManager.getName=function(){return CredentialsManager.get("name")};CredentialsManager.getIDUser=function(){return CredentialsManager.get("idUser")};CredentialsManager.getIDGroup=function(){return CredentialsManager.get("idGroup")};CredentialsManager.getGuidUser=function(){return CredentialsManager.get("guidUser")};
CredentialsManager.getEmail=function(){return CredentialsManager.get("email")};CredentialsManager.getEmailAlias=function(){return CredentialsManager.get("emailAlias")};CredentialsManager.getUniqueID=function(){return CredentialsManager.get("uniqueID")};CredentialsManager.getCulture=function(){return CredentialsManager.get("culture")};CredentialsManager.getIsFreeUser=function(){return CredentialsManager.get("isFreeUser")};CredentialsManager.getRefreshUserLastCall=function(){return CredentialsManager.get("refreshUserLastCall")};
CredentialsManager.getGetUserLoggedLastCall=function(){return CredentialsManager.get("getUserLoggedLastCall")};CredentialsManager.get=function(a){try{if(sessionStorage&&null!=sessionStorage[a])return sessionStorage[a]}catch(b){}return null};CredentialsManager.setName=function(a){return CredentialsManager.set("name",a)};CredentialsManager.setEmail=function(a){return CredentialsManager.set("email",a)};CredentialsManager.setEmailAlias=function(a){return CredentialsManager.set("emailAlias",a)};
CredentialsManager.setCulture=function(a){return CredentialsManager.set("culture",a)};CredentialsManager.setRefreshUserLastCall=function(a){return CredentialsManager.set("refreshUserLastCall",a)};CredentialsManager.setGetUserLoggedLastCall=function(a){return CredentialsManager.set("getUserLoggedLastCall",a)};CredentialsManager.set=function(a,b){try{sessionStorage&&(sessionStorage[a]=b),localStorage&&(sessionStorage.link&&sessionStorage.link===localStorage.link)&&(localStorage[a]=b)}catch(c){}};
CredentialsManager.store=function(a,b,c,d,e,f,g,h,i,j,k,n,l){try{if(CredentialsManager.clear()){sessionStorage.username=a;sessionStorage.password=b;sessionStorage.name=c;sessionStorage.idUser=d;sessionStorage.idGroup=e;sessionStorage.guidUser=f;sessionStorage.email=g;sessionStorage.emailAlias=h;sessionStorage.uniqueID=i;sessionStorage.culture=j;sessionStorage.isFreeUser=k;if(n){localStorage.username=a;localStorage.password=b;localStorage.name=c;localStorage.idUser=d;localStorage.idGroup=e;localStorage.guidUser=
f;localStorage.email=g;localStorage.emailAlias=h;localStorage.uniqueID=i;localStorage.culture=j;localStorage.isFreeUser=k;l&&(localStorage.localStorageExpiration=l.getTime().toString());var m=(new Date).getTime()+Math.random().toString().substr(2);sessionStorage.link=m;localStorage.link=m}if(CredentialsManager.areCredentialsStored())return!0;CredentialsManager.clear()}}catch(o){}return!1};
CredentialsManager.clear=function(){var a=CredentialsManager.clearSessionStorage(),b=CredentialsManager.clearLocalStorage();return a&&b};
CredentialsManager.clearSessionStorage=function(){try{if(sessionStorage)return sessionStorage.removeItem&&(sessionStorage.removeItem("username"),sessionStorage.removeItem("password"),sessionStorage.removeItem("name"),sessionStorage.removeItem("idUser"),sessionStorage.removeItem("idGroup"),sessionStorage.removeItem("guidUser"),sessionStorage.removeItem("email"),sessionStorage.removeItem("emailAlias"),sessionStorage.removeItem("uniqueID"),sessionStorage.removeItem("culture"),sessionStorage.removeItem("isFreeUser"),
sessionStorage.removeItem("refreshUserLastCall"),sessionStorage.removeItem("getUserLoggedLastCall"),sessionStorage.removeItem("link")),sessionStorage.username&&(sessionStorage.username=void 0,sessionStorage.password=void 0,sessionStorage.name=void 0,sessionStorage.idUser=void 0,sessionStorage.idGroup=void 0,sessionStorage.guidUser=void 0,sessionStorage.email=void 0,sessionStorage.emailAlias=void 0,sessionStorage.uniqueID=void 0,sessionStorage.culture=void 0,sessionStorage.isFreeUser=void 0,sessionStorage.refreshUserLastCall=
void 0,sessionStorage.getUserLoggedLastCall=void 0,sessionStorage.link=void 0),!0}catch(a){}return!1};
CredentialsManager.clearLocalStorage=function(){try{if(localStorage)return localStorage.removeItem&&(localStorage.removeItem("username"),localStorage.removeItem("password"),localStorage.removeItem("name"),localStorage.removeItem("idUser"),localStorage.removeItem("idGroup"),localStorage.removeItem("guidUser"),localStorage.removeItem("email"),localStorage.removeItem("emailAlias"),localStorage.removeItem("uniqueID"),localStorage.removeItem("culture"),localStorage.removeItem("isFreeUser"),localStorage.removeItem("refreshUserLastCall"),
localStorage.removeItem("getUserLoggedLastCall"),localStorage.removeItem("localStorageExpiration"),localStorage.removeItem("link")),localStorage.username&&(localStorage.username=void 0,localStorage.password=void 0,localStorage.name=void 0,localStorage.idUser=void 0,localStorage.idGroup=void 0,localStorage.guidUser=void 0,localStorage.email=void 0,localStorage.emailAlias=void 0,localStorage.uniqueID=void 0,localStorage.culture=void 0,localStorage.isFreeUser=void 0,localStorage.refreshUserLastCall=
void 0,localStorage.getUserLoggedLastCall=void 0,localStorage.localStorageExpiration=void 0,localStorage.link=void 0),!0}catch(a){}return!1};


function Util(){}Util.ISODateTimeToDate=function(a){return new Date(a.substr(0,4),parseInt(a.substr(5,2))-1,a.substr(8,2),a.substr(11,2),a.substr(14,2),a.substr(17,2),a.substr(20))};Util.ISODateToString=function(a){return a.substr(8,2)+"/"+a.substr(5,2)+"/"+a.substr(0,4)};Util.ISODateTimeToString=function(a){return a.substr(8,2)+"/"+a.substr(5,2)+"/"+a.substr(0,4)+" "+a.substr(11,2)+"."+a.substr(14,2)+"."+a.substr(17,2)};
Util.dateToString=function(a){var b=a.getDate(),c=a.getMonth()+1,a=a.getFullYear()+"";10>b&&(b="0"+b);for(10>c&&(c="0"+c);4>a.length;)a="0"+a;return b+"/"+c+"/"+a};Util.dateToISODate=function(a){var b=a.getDate(),c=a.getMonth()+1,a=a.getFullYear()+"";10>b&&(b="0"+b);for(10>c&&(c="0"+c);4>a.length;)a="0"+a;return a+"-"+c+"-"+b};
Util.dateToISODateTime=function(a,b,c){var d=a.getDate(),f=a.getMonth()+1,g=a.getFullYear()+"",i=a.getHours(),h=a.getMinutes(),e=a.getSeconds();10>d&&(d="0"+d);for(10>f&&(f="0"+f);4>g.length;)g="0"+g;10>i&&(i="0"+i);10>h&&(h="0"+h);10>e&&(e="0"+e);d=a.getFullYear()+"-"+f+"-"+d+"T"+i+":"+h+":"+e;b&&(d+="."+a.getMilliseconds());c&&(a=a.getTimezoneOffset(),0==a?d+="Z":(d+=0<a?"-":"+",a=Math.abs(a),b=parseInt(a/60),a-=60*b,10>b&&(b="0"+b),10>a&&(a="0"+a),d+=b+":"+a));return d};
Util.isValidDate=function(a,b,c){if(3==arguments.length){c=Util.toInt(c,null,1,31);b=Util.toInt(b,null,1,12);a=Util.toInt(a,null,1753,9999);if(null!==c&&null!==b&&null!==a){b--;var d=new Date(a,b,c);if(!isNaN(d.getTime())&&d.getDate()==c&&d.getMonth()==b&&d.getFullYear()==a)return!0}return!1}if(1==arguments.length){d=a;if("date"==$.type(d))return!isNaN(d.getTime());if(!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(d))return!1;d=d.split("/");return Util.isValidDate(d[2],d[1],d[0])}};
Util.isValidISODate=function(a){switch($.type(a)){case "date":return!isNaN(a.getTime());case "string":if(!/^\d{4}-\d{2}-\d{2}$/.test(a))return!1;a=a.split("-");return Util.isValidDate(a[0],a[1],a[2]);default:return!1}};
Date.prototype.addMonths=function(a,b,c,d,f,g,i){var h=this.getMonth(),e=h+a;0>e?(this.setFullYear(this.getFullYear()+parseInt(e/12)-1),e=12+e%12):11<e&&(this.setFullYear(this.getFullYear()+parseInt(e/12)),e%=12);for(e!==h&&this.setMonth(e);this.getMonth()>e;)this.setTime(this.getTime()-864E5);1<arguments.length&&this.addWeeks(b,c,d,f,g,i)};Date.prototype.addWeeks=function(a,b,c,d,f,g){this.addDays(7*a+(b||0),c,d,f,g)};Date.prototype.addDays=function(a,b,c,d,f){this.addHours(24*a+(b||0),c,d,f)};
Date.prototype.addHours=function(a,b,c,d){this.addMinutes(60*a+(b||0),c,d)};Date.prototype.addMinutes=function(a,b,c){this.addSeconds(60*a+(b||0),c)};Date.prototype.addSeconds=function(a,b){this.addMilliseconds(1E3*a+(b||0))};Date.prototype.addMilliseconds=function(a){this.setTime(this.getTime()+a);return this};Util.numberToString=function(a){a=(a+"").replace(",",".");a=a.split(".");return a[0]+(1<a.length&&"00"!=a[1]?Translations.currentCulture.decimalSeparator+a[1]:"")};
Util.numberToStringThousSep=function(a){for(var a=(a+"").replace(",","."),b=a.split("."),a=b[0],b=1<b.length&&"00"!=b[1]?Translations.currentCulture.decimalSeparator+b[1]:"",c=/(\d+)(\d{3})/;c.test(a);)a=a.replace(c,"$1"+Translations.currentCulture.thousandSeparator+"$2");return a+b};Util.toBool=function(a,b){switch(typeof a){case "boolean":return a;case "string":if("true"===a)return!0;if("false"===a)return!1;break;case "number":if(1===a)return!0;if(0===a)return!1}return 2<=arguments.length?b:null};
Util.toInt=function(a,b,c,d){return Util._toNumber(a,!1,2<=arguments.length?b:null,c,d)};Util.toFloat=function(a,b,c,d){return Util._toNumber(a,!0,2<=arguments.length?b:null,c,d)};Util._toNumber=function(a,b,c,d,f){var g=typeof a;switch(g){case "boolean":return a?1:0;case "string":case "number":if("string"===g&&(a=Util.trim(a.replace(",","."))),/^(-)?\d+(\.\d*)?$/.test(a)&&(a=b?parseFloat(a):parseInt(a,10),!isNaN(a)&&("number"!==typeof d||a>=d)&&("number"!==typeof f||a<=f)))return a}return c};
Util.round=function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});Util.trim=function(a){return a.trim()};String.prototype.trimStart=function(){return this.replace(/^\s+/,"")};Util.trimStart=function(a){return a.trimStart()};String.prototype.trimEnd=function(){return this.replace(/\s+$/,"")};Util.trimEnd=function(a){return a.trimEnd()};
Util.normalizeEndLines=function(a){return a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\n/g,"\r\n")};Util.format=String.format=function(){for(var a=arguments[0],b=0;b<arguments.length-1;b++)a=a.replace(RegExp("\\{"+b+"\\}","gm"),arguments[b+1]);return a};String.prototype.format=function(){for(var a=this.toString(),b=0;b<arguments.length;b++)a=a.replace(RegExp("\\{"+b+"\\}","gm"),arguments[b]);return a};
Util.htmlEscape=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\r/g,"&#13;").replace(/\n/g,"&#10;")};
Util.textToXaml=function(a){var b='<FlowDocument PagePadding="5,0,5,0" AllowDrop="True" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">';if(a=="")b=b+'<Paragraph Margin="0,0,0,0" FontFamily="Verdana" FontSize="12" />';else for(var a=Util.normalizeEndLines(a).split("\r\n"),c=0;c<a.length;c++){b=b+'<Paragraph Margin="0,0,0,0" FontFamily="Verdana" FontSize="12"';if(a[c]=="")b=b+" />";else{b=b+"><Run";if(a[c].indexOf("  ")!=-1||a[c].indexOf("\t")!=-1)b=b+' xml:space="preserve"';b=b+
(">"+Util.htmlEscape(a[c])+"</Run></Paragraph>")}}return b+"</FlowDocument>"};Util.emptyStringTo=function(a,b){return a===""?b:a};Util.createNewGuid=function(){for(var a="",b=0;b<32;b++){if(b==8||b==12||b==16||b==20)a=a+"-";if(b==12)a=a+"f";else var c=parseInt(Math.random()*16),a=a+(b==16?c&3|8:c).toString(16)}return a};
Util.x2jXmlToObj=function(a){if(!a)return null;var b={},c;for(c in a){var d=a[c];$.type(d)=="array"&&(d.length>0&&$.type(d[0].Text)=="string")&&(b[c]=d[0]["@i:nil"]==="true"?null:d[0].Text)}return b};Util.x2jXmlToArray=function(a){var b=[];if(a)for(var c=0;c<a.length;c++)b.push(Util.x2jXmlToObj(a[c]));return b};Array.prototype.contains=function(a){return $.inArray(a,this)!==-1};


$(document).on("pageshow","#boat_view",function(){var a=$("#Gallery > li").length;0<a&&($("#Gallery").css("width",278*a),Common.iScrollContainer.boat_view_images?Common.iScrollContainer.boat_view_images.refresh():Common.iScrollContainer.boat_view_images=new iScroll("wrapper"),$("#Gallery a").photoSwipe({backButtonHideEnabled:!1}))});
function sendEmail(){Email.showPage({subject:$("#emailSubject").val(),attachment:$("#emailAttachment").val(),emailType:$("#emailEmailType").val(),objID:$("#emailObjID").val(),objType:$("#emailObjType").val(),pdfFileName:$("#emailPdfFileName").val(),back:$.mobile.urlHistory.getActive().url})}function print(a,b,c,d){Common.pdfViewer.show({group_id:a,boat_code:b,print_type:c,num_header:1,id_sede:"",download:0,culture:d,header:$("#Title").text()})};


(function(m){function r(a){this.parent=a||null}function h(a){this.nodeName=a||"";this.ns=""}function j(){var a=null,b=null,c=null;switch(arguments.length){case 1:b=arguments[0];break;case 2:a=arguments[0];b=arguments[1];break;case 3:a=arguments[0];b=arguments[1];c=arguments[2];break;default:b="noname"}h.apply(this,[b]);r.apply(this,[a]);this.Text=c||""}function p(){var a=[];m.extend(a,s);return a}var n=Object.prototype.toString,f={isIE:function(){return NaN===0},isStr:function(a){return"[object String]"===
n.call(a)},isFn:function(a){return"[object Function]"===n.call(a)},isDef:function(a){return"undefined"!==typeof a},isArr:function(a){return"[object Array]"===n.call(a)},isNum:function(a){var b=!1;f.isStr(a)&&(b=/^((-)?([0-9]*)((\.{0,1})([0-9]+))?$)/.test(a));return b},isXNode:function(a){return"object"===typeof a&&this.isDef(a.nodeName)},isNodeSet:function(a){return f.isArr(a)},trim:function(a){var b=a;this.isStr(a)&&(b=a.replace(/^\s\s*/,"").replace(/\s\s*$/,""));return b},formatName:function(a){return this.trim(String(a))}},
k={newDocument:function(a,b){a||(a="");b||(b="");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b,a,null);var c=new ActiveXObject("MSXML2.DOMDocument");if(a){var e="",d=a,f=a.indexOf(":");-1!==f&&(e=a.substring(0,f),d=a.substring(f+1));b?e||(e="a0"):e="";c.loadXML("<"+(e?e+":":"")+d+(b?" xmlns:"+e+'="'+b+'"':"")+"/>")}return c},objToNode:function(a,b){var c,e,d;if(f.isDef(a)&&f.isDef(b))for(c in b)if(b.hasOwnProperty&&b.hasOwnProperty(c))if(e=
b[c],-1!==c.indexOf("@"))a.setAttribute(c.replace("@",""),e);else if("$comments"===c){if(e.length){d=0;var g=e.length-1,h;do h=e[d],a.appendChild(this.createComment(h));while(d++<g)}}else if(f.isNodeSet(e)){g=0;h=e.length-1;var i;do i=e[g],d=i.ns?f.isDef(this.createElementNS)?a.appendChild(this.createElementNS(i.ns,c)):a.appendChild(this.createNode(1,c,i.ns)):a.appendChild(this.createElement(c)),i.Text&&d.appendChild(f.isDef(i.hasCDATA)?this.createCDATASection(i.Text):this.createTextNode(i.Text)),
k.objToNode.call(this,d,i);while(g++<h)}}},s={getNodesByAttribute:function(a,b){var c=[],e=this.length,d,g;if(e&&f.isStr(a)&&f.isDef(b))for(;e--;)d=this[e],g=d[a],f.isDef(g)&&g===b&&c.unshift(d);return!c.length?NULL:c},getNodesByValue:function(a){var b=[],c=this.length,e;if(c&&f.isDef(a))for(;c--;)e=this[c],e.Text===a&&b.unshift(e);return!b.length?NULL:b},contains:function(a,b){var c=FALSE,e=this.length,d;if(e&&f.isStr(a)&&f.isDef(b))for(;e--;)if(d=this[e],d=d[a],f.isDef(d)&&d===b){c=TRUE;break}return c},
indexOf:function(){var a=-1,b,c,e=this.length,d;if(e)switch(arguments.length){case 1:for(c=arguments[0];e--;)if(d=this[e],d=d.val(),f.isDef(d)&&d===c){a=e;break}break;case 2:b=arguments[0];for(c=arguments[1];e--;)if(d=this[e],d=d[b],f.isDef(d)&&d===c){a=e;break}}return a},sortByAttribute:function(a,b){this.length&&f.isStr(a)&&this.sort(function(c,e){var d=c.attr(a),g=e.attr(a),d=f.isNum(d)?parseFloat(d):d,g=f.isNum(g)?parseFloat(g):g,d=d<g?-1:g<d?1:0;return d=f.isDef(b)&&"desc"===b.toLowerCase()?
0-d:d})},sortByValue:function(a){this.length&&this.sort(function(b,c){var e=b.Text,d=c.Text,e=f.isNum(e)?parseFloat(e):e,d=f.isNum(d)?parseFloat(d):d,e=e<d?-1:d<e?1:0;return e=f.isDef(a)&&"desc"===a.toLowerCase()?0-e:e})},sortByChildNode:function(a,b){this.length&&f.isStr(a)&&this.sort(function(c,e){var d=c[a],g=e[a],d=f.isDef(d)&&d.length?d[0].Text:NULL,g=f.isDef(g)&&g.length?g[0].Text:NULL,d=f.isNum(d)?parseFloat(d):d,g=f.isNum(g)?parseFloat(g):g,d=d<g?-1:g<d?1:0;return d=f.isDef(b)&&"desc"===b.toLowerCase()?
0-d:d})},first:function(){var a=NULL;this.length&&(a=this[0]);return a},last:function(){var a=NULL;this.length&&(a=this[this.length-1]);return a}},l,o={makeNodeSet:function(){return p()},makeNode:function(a,b){var c=b.localName||b.baseName,c=f.trim(c),c=new j(a,c);c.ns=b.prefix||"";this.setAttributes(c,b);return c},setAttributes:function(a,b){if(f.isDef(b)&&b.attributes.length){var c=b.attributes.length-1,e=null;do e="@"+b.attributes[c].name,a.attr(e,b.attributes[c].value);while(c--)}},run:function(a,
b){var c,e;if(f.isDef(a)&&f.isDef(b)&&b.hasChildNodes()){var d=b.childNodes.length-1,g=0;do switch(c=b.childNodes[g],c.nodeType){case 1:e=o.makeNode(a,c);if(f.isFn(this.decorator)&&!1===this.decorator.call(e))continue;e&&(a.appendChild(e),c.hasChildNodes()&&o.run.apply(this,[e,c]));break;case 3:a.Text?a.Text+=f.trim(c.nodeValue):a.val(f.trim(c.nodeValue));break;case 4:a.hasCDATA=!0;a.val(f.isDef(c.text)?f.trim(c.text):f.trim(c.nodeValue));break;case 8:if(!f.isDef(this.noComments)||!this.noComments)f.isDef(a.$comments)||
(a.$comments=[]),a.$comments.push(f.trim(c.nodeValue))}while(g++<d)}},init:function(a,b){b=b||{noComments:!0};f.isStr(a)?a=this.textToXML(a):f.isXNode(a)||(a=null);if(!a)return null;var c=9===a.nodeType?a.documentElement:11===a.nodeType?a.firstChild:a,e=new h(c.nodeName);f.isFn(b.decorator)&&b.decorator.call(e);if(3===a.nodeType||4===a.nodeType)return a.nodeValue;this.run.apply(b,[e,c]);this.setAttributes(e,c);return e},textToXML:function(a){var b=null;try{b=f.isIE()?new ActiveXObject("MSXML2.DOMDocument"):
new DOMParser,b.async=!1}catch(c){throw Error("XML Parser could not be instantiated");}var e=null,d=!0;f.isIE()?e=(d=b.loadXML(a))?b:!1:(e=b.parseFromString(a,"text/xml"),d="parsererror"!==e.documentElement.tagName);if(!d)throw Error("Error parsing XML string");return e}};l=o;h.prototype={typeOf:"xmlObjectifier",attr:function(){var a,b,c;if(arguments.length)switch(arguments.length){case 1:b=f.trim(arguments[0]);c=this["@"+b]||this[b];f.isDef(c)&&!f.isArr(c)&&(a=c);break;case 2:b=f.trim(arguments[0]),
c=arguments[1],f.isStr(b)&&(this[/^@/.test(b)?b:"@"+b]=c,a=this)}return a},find:function(a){var b=null,c,e;if(f.isStr(a)){var d,g=/\[(\d+|@\w+(=\w+)?)\]/,h=/^@\w+/;if(a.match(h))return e=a.match(h)[0],this.attr(e);a=a.match(/(?=\.)?([A-Za-z\-]+(\[(\d+|@\w+(=\w+)?)\])?)/g);if(a.length){b=0;h=a.length-1;do{c=a[b];e=c.match(/[A-Za-z\-]+/)[0];d=d?(f.isArr(d)?d[0]:d)[e]:this[e];if(!d)break;if((c=!!c.match(g)&&c.match(g)[0].replace("[","").replace("]",""))&&c.length)-1!==c.indexOf("=")?(c=c.split("="),
e=f.trim(c[0]),c=f.trim(c[1]),-1!==e.indexOf("@")?d=d.getNodesByAttribute(e,c):(e=f.trim(d[e]))&&(d=e.getNodesByValue(c))):f.isNum(c)&&(d=d[~~+c])}while(b++<h);b=d}}return b},addComment:function(a){f.isStr(a)&&(f.isDef(this.$comments)||(this.$comments=[]),this.$comments.push(a));return this},val:function(a){var b=this;f.isDef(a)?this.Text=a:b=this.Text;return b},toXML:function(){var a=k.newDocument(this.nodeName,this.ns);k.objToNode.call(a,a.documentElement,this);return a},toString:function(){var a=
this.toXML(),b="";f.isDef(a.xml)?b=a.xml:f.isDef(k)&&(b=(new window.XMLSerializer).serializeToString(a));return b},appendChild:function(a){if(f.isDef(a)&&a instanceof j){a.parent=this;if(!f.isDef(this[a.nodeName])||!f.isArr(this[a.nodeName]))this[a.nodeName]=l.makeNodeSet();this[a.nodeName].push(a)}}};j.prototype={attr:h.prototype.attr,val:h.prototype.val,find:h.prototype.find,addComment:h.prototype.addComment,appendChild:h.prototype.appendChild};var q={xmlToJSON:function(a,b){return l.init(a,b)},
textToXML:l.textToXML,xmlObjectifier:{RootClass:h,NodeClass:j,NodeSetClass:p}};f.isDef(m)?m.extend(q):window.XMLObjectifier=q})("undefined"!==typeof jQuery&&jQuery||void 0);

